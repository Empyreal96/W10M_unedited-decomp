// sub_931184 
 
// local variable allocation has failed, the output may be wrong!
int __fastcall sub_931184(int a1, int a2, unsigned int a3, int a4, int a5)
{
  int v5; // r5
  __int64 v6; // r0
  int v7; // r0
  int v8; // r6
  int *i; // r2
  int v10; // r3
  int v11; // r5
  int *j; // r2
  int v13; // r3
  __int64 v14; // r0
  int v15; // r0
  unsigned int v16; // r4
  int v17; // r0
  int v18; // r0
  __int64 v19; // kr00_8
  int v20; // r3
  int v21; // r2
  int v22; // r6
  unsigned int v23; // r5
  __int64 v24; // r0
  int v25; // r0
  unsigned int v26; // r3
  unsigned int v27; // r5
  int v28; // r3
  __int64 v29; // kr08_8
  int v30; // r4
  unsigned int v31; // r1
  unsigned int v32; // r3
  unsigned int v33; // kr18_4
  unsigned __int64 v34; // r2
  unsigned __int64 v35; // r2
  unsigned int v36; // r3
  unsigned int v37; // r5
  int v38; // r3
  __int64 v39; // kr28_8
  int v40; // r1
  int v41; // r2
  int v42; // r7
  int v43; // r6
  unsigned int v44; // r5
  unsigned int v45; // r4
  int v46; // r0
  int v47; // r3
  int *v48; // r2
  int v49; // lr
  __int64 v50; // r2
  unsigned int v51; // r1
  int v52; // r2
  unsigned int v53; // r0
  int v54; // r4
  unsigned int v55; // r1
  int v56; // r8
  unsigned int *v57; // r0
  unsigned int v58; // r2
  unsigned int v59; // r0
  _DWORD *v60; // r10
  int v61; // r9
  unsigned int v62; // r4
  unsigned int v63; // r2
  _DWORD *v64; // r1
  unsigned int v65; // r3
  unsigned int v66; // r5
  int v67; // r3
  __int64 v68; // kr48_8
  int v69; // r4
  unsigned int v70; // r1
  unsigned int v71; // r3
  unsigned int v72; // kr58_4
  unsigned __int64 v73; // r2
  int v74; // r2
  int v75; // r3
  char v76; // r2
  __int64 v77; // r0
  __int64 v78; // r0
  __int64 v79; // r0
  __int64 v80; // r0
  __int64 v81; // r0
  __int64 v82; // r0
  __int64 v83; // r0
  __int64 v84; // r0
  __int64 v85; // r0
  unsigned int v86; // r3
  unsigned int v87; // r5
  int v88; // r3
  __int64 v89; // kr68_8
  unsigned int v90; // r1
  unsigned int v91; // r4
  int v92; // r7
  unsigned int v93; // r5
  int v94; // r6
  int v95; // r4
  int v96; // r6
  int *v97; // r2
  char *v98; // r4
  unsigned int v99; // r1
  unsigned int v100; // r5
  int v101; // r3
  int v102; // r4
  _DWORD *v103; // r3
  unsigned int v104; // r3
  int v105; // r4
  unsigned int v106; // r1
  int v107; // r8
  unsigned int *v108; // r0
  unsigned int v109; // r2
  int v110; // lr
  unsigned int v111; // r0
  _DWORD *v112; // r10
  int v113; // r9
  unsigned int v114; // r4
  unsigned int v115; // r2
  _DWORD *v116; // r1
  unsigned int v117; // r3
  unsigned int v118; // r5
  int v119; // r3
  __int64 v120; // kr78_8
  int v121; // r4
  unsigned int v122; // r1
  unsigned int v123; // r3
  unsigned int v124; // kr88_4
  unsigned __int64 v125; // r2
  int v126; // r2
  int v127; // r3
  char v128; // r2
  __int64 v129; // r0
  __int64 v130; // r0
  __int64 v131; // r0
  __int64 v132; // r0
  __int64 v133; // r0
  __int64 v134; // r0
  __int64 v135; // r0
  __int64 v136; // r0
  __int64 v137; // r0
  unsigned int v138; // r3
  unsigned int v139; // r5
  int v140; // r3
  __int64 v141; // kr98_8
  unsigned int v142; // r1
  unsigned int v143; // r4
  int v144; // r7
  unsigned int v145; // r5
  int v146; // r6
  int v147; // r4
  int v148; // r0
  int v149; // r6
  int *v150; // r2
  char *v151; // r4
  unsigned int v152; // r1
  unsigned int v153; // r5
  int v154; // r3
  int v155; // r0
  _DWORD *v156; // r3
  int v157; // r2
  int v158; // r2
  int v159; // r8
  unsigned int v160; // r3
  unsigned int v161; // r5
  int v162; // r3
  __int64 v163; // krA0_8
  int v164; // r4
  unsigned int v165; // r1
  unsigned int v166; // r3
  unsigned int v167; // krB0_4
  unsigned __int64 v168; // r2
  int v169; // r8
  unsigned int v170; // r3
  unsigned int v171; // r5
  int v172; // r3
  __int64 v173; // krC0_8
  int v174; // r4
  unsigned int v175; // r1
  unsigned int v176; // r3
  unsigned int v177; // krD0_4
  unsigned __int64 v178; // r2
  int v179; // r9
  unsigned int v180; // r3
  unsigned int v181; // r6
  int v182; // r3
  __int64 v183; // krE0_8
  int v184; // r5
  unsigned int v185; // r1
  unsigned int v186; // r3
  unsigned int v187; // krF0_4
  unsigned __int64 v188; // r2
  unsigned int v189; // r10
  unsigned int v190; // r3
  unsigned int v191; // r5
  int v192; // r3
  __int64 v193; // kr100_8
  int v194; // r4
  unsigned int v195; // r1
  unsigned int v196; // r3
  unsigned int v197; // kr110_4
  unsigned __int64 v198; // r2
  int v199; // r2
  int v200; // r3
  char v201; // r2
  __int64 v202; // r0
  __int64 v203; // r0
  __int64 v204; // r0
  __int64 v205; // r0
  __int64 v206; // r0
  __int64 v207; // r0
  __int64 v208; // r0
  __int64 v209; // r0
  __int64 v210; // r0
  unsigned int v211; // r3
  unsigned int v212; // r5
  int v213; // r3
  __int64 v214; // kr120_8
  unsigned int v215; // r1
  unsigned int v216; // r4
  int v217; // r7
  unsigned int v218; // r5
  int v219; // r6
  int v220; // r4
  int v221; // r0
  _DWORD *v222; // r7
  unsigned int v223; // r8
  unsigned int v224; // r9
  unsigned int v225; // r3
  unsigned int v226; // r5
  int v227; // r3
  __int64 v228; // kr128_8
  __int64 v229; // kr130_8
  unsigned int v230; // r2
  int v231; // r3
  unsigned int v232; // r3
  unsigned int v233; // r5
  int v234; // r3
  __int64 v235; // kr148_8
  __int64 v236; // kr150_8
  unsigned int v237; // r2
  int v238; // r3
  int v239; // r0
  unsigned int v240; // r1
  unsigned int v241; // r7
  int v242; // r8
  bool v243; // cf
  _DWORD *v244; // r9
  unsigned int v245; // r10
  unsigned int v246; // r3
  unsigned int v247; // r5
  int v248; // r3
  __int64 v249; // kr168_8
  __int64 v250; // kr170_8
  unsigned int v251; // r2
  int v252; // r3
  unsigned int v253; // r3
  unsigned int v254; // r5
  int v255; // r3
  __int64 v256; // kr188_8
  __int64 v257; // kr190_8
  unsigned int v258; // r2
  int v259; // r3
  int v260; // r0
  unsigned int v261; // r1
  int v262; // r9
  int v263; // r5
  unsigned int v264; // r6
  int v265; // r7
  unsigned int v266; // r4
  int v267; // r0
  int v268; // r3
  int *v269; // r2
  int v270; // lr
  __int64 v271; // r2
  unsigned int v272; // r1
  int v273; // r2 OVERLAPPED
  unsigned int v274; // r1 OVERLAPPED
  unsigned int v275; // r3
  int v276; // r4
  unsigned int v277; // r1
  unsigned int *v278; // r0
  int v279; // r9
  unsigned int v280; // r2
  unsigned int v281; // r0
  _DWORD *v282; // r3
  _DWORD *v283; // r3
  int v284; // r10
  unsigned int v285; // r4
  unsigned int v286; // r1
  _DWORD *v287; // r2
  unsigned int v288; // r3
  unsigned int v289; // r5
  int v290; // r3
  __int64 v291; // kr1B0_8
  int v292; // r4
  unsigned int v293; // r1
  unsigned int v294; // r3
  unsigned int v295; // kr1C0_4
  unsigned __int64 v296; // r2
  int v297; // r2
  int v298; // r3
  char v299; // r2
  __int64 v300; // r0
  __int64 v301; // r0
  __int64 v302; // r0
  __int64 v303; // r0
  __int64 v304; // r0
  __int64 v305; // r0
  __int64 v306; // r0
  __int64 v307; // r0
  __int64 v308; // r0
  unsigned int v309; // r3
  unsigned int v310; // r5
  int v311; // r3
  __int64 v312; // kr1D0_8
  unsigned int v313; // r1
  unsigned int v314; // r4
  int v315; // r7
  unsigned int v316; // r5
  int v317; // r6
  int v318; // r4
  int v319; // r6
  int *v320; // r2
  char *v321; // r4
  unsigned int v322; // r1
  unsigned int v323; // r5
  int v324; // r3
  int v325; // r4
  _DWORD *v326; // r3
  _DWORD *v327; // r2
  unsigned int v328; // r3
  int v329; // r4
  unsigned int v330; // r1
  unsigned int *v331; // r0
  int v332; // r9
  unsigned int v333; // r2
  unsigned int v334; // r0
  int v335; // lr
  _DWORD *v336; // r3
  _DWORD *v337; // r3
  int v338; // r10
  unsigned int v339; // r4
  unsigned int v340; // r2
  _DWORD *v341; // r1
  unsigned int v342; // r3
  unsigned int v343; // r5
  int v344; // r3
  __int64 v345; // kr1E0_8
  int v346; // r4
  unsigned int v347; // r1
  unsigned int v348; // r3
  unsigned int v349; // kr1F0_4
  unsigned __int64 v350; // r2
  int v351; // r2
  int v352; // r3
  char v353; // r2
  __int64 v354; // r0
  __int64 v355; // r0
  __int64 v356; // r0
  __int64 v357; // r0
  __int64 v358; // r0
  __int64 v359; // r0
  __int64 v360; // r0
  __int64 v361; // r0
  __int64 v362; // r0
  unsigned int v363; // r3
  unsigned int v364; // r5
  int v365; // r3
  __int64 v366; // kr200_8
  unsigned int v367; // r1
  unsigned int v368; // r4
  int v369; // r7
  unsigned int v370; // r5
  int v371; // r6
  int v372; // r4
  int v373; // r0
  int v374; // r6
  int *v375; // r2
  char *v376; // r4
  unsigned int v377; // r1
  unsigned int v378; // r5
  int v379; // r3
  int v380; // r0
  _DWORD *v381; // r3
  unsigned int v382; // r1
  char *v383; // r4
  _DWORD **v384; // r2
  _DWORD *v385; // r3
  unsigned int v386; // r0
  int *v387; // r2
  char *v388; // r5
  unsigned int v389; // r7
  int v390; // r3
  int v391; // r5
  unsigned int v392; // r4
  int v393; // r9
  int v394; // r3
  unsigned int v395; // r3
  unsigned int v396; // r5
  int v397; // r3
  __int64 v398; // kr210_8
  int v399; // r4
  unsigned int v400; // r1
  unsigned int v401; // r3
  unsigned int v402; // kr220_4
  unsigned __int64 v403; // r2
  unsigned __int64 v404; // r2
  unsigned int v405; // r3
  unsigned int v406; // r5
  int v407; // r3
  __int64 v408; // kr230_8
  int v409; // r4
  unsigned int v410; // r1
  unsigned int v411; // r3
  unsigned int v412; // kr240_4
  unsigned __int64 v413; // r2
  int v414; // r2
  int v415; // r5
  __int64 v416; // r0
  int v417; // r3
  char v418; // r2
  int v419; // r0
  unsigned int v420; // r3
  unsigned int v421; // r5
  int v422; // r3
  __int64 v423; // kr250_8
  int v424; // r4
  unsigned int v425; // r1
  unsigned int v426; // r3
  unsigned int v427; // kr260_4
  unsigned __int64 v428; // r2
  unsigned __int64 v429; // r2
  __int64 v430; // r0
  unsigned int v431; // r3
  unsigned int v432; // r5
  int v433; // r3
  __int64 v434; // kr270_8
  int v435; // r4
  unsigned int v436; // r1
  unsigned int v437; // r3
  unsigned int v438; // kr280_4
  unsigned __int64 v439; // r2
  int v440; // r3
  int v441; // r3
  char v442; // r2
  __int64 v443; // r0
  __int64 v444; // r0
  __int64 v445; // r0
  __int64 v446; // r0
  __int64 v447; // r0
  __int64 v448; // r0
  __int64 v449; // r0
  __int64 v450; // r0
  __int64 v451; // r0
  unsigned int v452; // r3
  unsigned int v453; // r5
  int v454; // r3
  __int64 v455; // kr290_8
  unsigned int v456; // r1
  unsigned int v457; // r4
  int v458; // r7
  unsigned int v459; // r5
  int v460; // r6
  int v461; // r4
  unsigned int v462; // r3
  unsigned int v463; // r5
  int v464; // r3
  __int64 v465; // kr298_8
  int v466; // r4
  unsigned int v467; // r1
  unsigned int v468; // r3
  unsigned int v469; // kr2A8_4
  unsigned __int64 v470; // r2
  int v471; // r2
  unsigned int v472; // r3
  unsigned int v473; // r5
  int v474; // r3
  __int64 v475; // kr2B8_8
  __int64 v476; // kr2C0_8
  unsigned int v477; // r2
  int v478; // r3
  int v479; // r2
  unsigned int v480; // r3
  unsigned int v481; // r5
  int v482; // r3
  __int64 v483; // kr2D8_8
  int v484; // r4
  unsigned int v485; // r1
  unsigned int v486; // r3
  unsigned int v487; // kr2E8_4
  unsigned __int64 v488; // r2
  unsigned __int64 v489; // r2
  unsigned int v490; // r3
  unsigned int v491; // r5
  int v492; // r3
  __int64 v493; // kr2F8_8
  int v494; // r4
  unsigned int v495; // r1
  unsigned int v496; // r3
  unsigned int v497; // kr308_4
  unsigned __int64 v498; // r2
  unsigned __int64 v499; // r2
  unsigned int v500; // r3
  unsigned int v501; // r5
  int v502; // r3
  __int64 v503; // kr318_8
  int v504; // r4
  unsigned int v505; // r1
  unsigned int v506; // r3
  unsigned int v507; // kr328_4
  unsigned __int64 v508; // r2
  int v509; // r2
  int v510; // r3
  unsigned int v511; // r3
  unsigned int v512; // r5
  int v513; // r3
  __int64 v514; // kr338_8
  int v515; // r4
  unsigned int v516; // r1
  unsigned int v517; // r3
  unsigned int v518; // kr348_4
  unsigned __int64 v519; // r2
  unsigned __int64 v520; // r2
  unsigned int v521; // r3
  unsigned int v522; // r5
  int v523; // r3
  __int64 v524; // kr358_8
  int v525; // r4
  unsigned int v526; // r1
  unsigned int v527; // r3
  unsigned int v528; // kr368_4
  unsigned __int64 v529; // r2
  int v530; // r2
  int v531; // r3
  unsigned int v532; // r3
  unsigned int v533; // r5
  int v534; // r3
  __int64 v535; // kr378_8
  int v536; // r4
  unsigned int v537; // r1
  unsigned int v538; // r3
  unsigned int v539; // kr388_4
  unsigned __int64 v540; // r2
  int v541; // r0
  unsigned __int64 v542; // r2
  int v543; // r5
  unsigned int v544; // r3
  unsigned int v545; // r5
  int v546; // r3
  __int64 v547; // kr398_8
  int v548; // r4
  unsigned int v549; // r1
  unsigned int v550; // r3
  unsigned int v551; // kr3A8_4
  unsigned __int64 v552; // r2
  unsigned __int64 v553; // r2
  int v555; // [sp+18h] [bp-B90h]
  __int64 v556; // [sp+18h] [bp-B90h]
  int v557; // [sp+1Ch] [bp-B8Ch]
  int v558; // [sp+1Ch] [bp-B8Ch]
  int v559; // [sp+20h] [bp-B88h]
  int v560; // [sp+20h] [bp-B88h]
  unsigned int v561; // [sp+20h] [bp-B88h]
  unsigned int v562; // [sp+24h] [bp-B84h]
  int v563; // [sp+24h] [bp-B84h]
  unsigned int v564; // [sp+30h] [bp-B78h]
  unsigned int v565; // [sp+34h] [bp-B74h]
  unsigned int v566; // [sp+38h] [bp-B70h]
  unsigned int v567; // [sp+3Ch] [bp-B6Ch]
  int v568; // [sp+48h] [bp-B60h]
  unsigned int v569; // [sp+50h] [bp-B58h]
  int v570; // [sp+50h] [bp-B58h]
  unsigned int v571; // [sp+58h] [bp-B50h]
  unsigned int v572; // [sp+58h] [bp-B50h]
  unsigned int v573; // [sp+60h] [bp-B48h]
  int v574; // [sp+64h] [bp-B44h]
  int v575; // [sp+68h] [bp-B40h]
  int v576; // [sp+68h] [bp-B40h]
  _DWORD *v577; // [sp+70h] [bp-B38h]
  unsigned int v578; // [sp+70h] [bp-B38h]
  unsigned int v579; // [sp+78h] [bp-B30h]
  unsigned int v580; // [sp+78h] [bp-B30h]
  unsigned int v581; // [sp+78h] [bp-B30h]
  int v582; // [sp+80h] [bp-B28h]
  int v583; // [sp+80h] [bp-B28h]
  int v584; // [sp+80h] [bp-B28h]
  unsigned int v585; // [sp+94h] [bp-B14h]
  unsigned int v586; // [sp+98h] [bp-B10h]
  _DWORD *v587; // [sp+98h] [bp-B10h]
  int v588; // [sp+B4h] [bp-AF4h]
  int v589[2]; // [sp+13Ch] [bp-A6Ch] BYREF
  int v590; // [sp+144h] [bp-A64h]
  int v591; // [sp+14Ch] [bp-A5Ch]
  int v592; // [sp+154h] [bp-A54h]
  int v593; // [sp+15Ch] [bp-A4Ch]
  int v594; // [sp+164h] [bp-A44h]
  int v595; // [sp+16Ch] [bp-A3Ch]
  int v596; // [sp+174h] [bp-A34h]
  int v597; // [sp+17Ch] [bp-A2Ch]
  int v598; // [sp+184h] [bp-A24h]
  int v599; // [sp+18Ch] [bp-A1Ch]
  int v600; // [sp+194h] [bp-A14h]
  int v601; // [sp+19Ch] [bp-A0Ch]
  int v602; // [sp+1A4h] [bp-A04h]
  int v603; // [sp+1ACh] [bp-9FCh]
  int v604; // [sp+1B4h] [bp-9F4h]
  int v605; // [sp+1BCh] [bp-9ECh]
  int v606; // [sp+1C4h] [bp-9E4h]
  int v607; // [sp+1DCh] [bp-9CCh]
  int v608; // [sp+23Ch] [bp-96Ch]
  int v609; // [sp+260h] [bp-948h]
  int v610; // [sp+264h] [bp-944h]
  int v611; // [sp+268h] [bp-940h]
  int v612; // [sp+26Ch] [bp-93Ch]
  int v613; // [sp+270h] [bp-938h]
  int v614; // [sp+274h] [bp-934h]
  int v615; // [sp+278h] [bp-930h]
  int v616; // [sp+27Ch] [bp-92Ch]
  int v617; // [sp+280h] [bp-928h]
  int v618; // [sp+284h] [bp-924h]
  int v619; // [sp+288h] [bp-920h]
  int v620; // [sp+28Ch] [bp-91Ch]
  int v621; // [sp+290h] [bp-918h]
  int v622; // [sp+294h] [bp-914h]
  int v623; // [sp+298h] [bp-910h]
  int v624; // [sp+2A0h] [bp-908h]
  unsigned int v625; // [sp+2A8h] [bp-900h]
  int v626; // [sp+2B0h] [bp-8F8h]
  int v627; // [sp+2B8h] [bp-8F0h]
  int v628; // [sp+2C0h] [bp-8E8h]
  int v629; // [sp+2C8h] [bp-8E0h]
  int v630; // [sp+2D0h] [bp-8D8h]
  int v631; // [sp+2D8h] [bp-8D0h]
  int v632; // [sp+2E0h] [bp-8C8h]
  int v633; // [sp+2E8h] [bp-8C0h]
  int v634; // [sp+2F0h] [bp-8B8h]
  int v635; // [sp+2F8h] [bp-8B0h]
  int v636; // [sp+2FCh] [bp-8ACh]
  int v637; // [sp+300h] [bp-8A8h] BYREF
  int v638; // [sp+308h] [bp-8A0h]
  int v639; // [sp+30Ch] [bp-89Ch]
  int v640; // [sp+310h] [bp-898h]
  int v641; // [sp+318h] [bp-890h]
  int v642; // [sp+320h] [bp-888h]
  int v643; // [sp+328h] [bp-880h]
  __int64 *v644; // [sp+32Ch] [bp-87Ch] BYREF
  int v645; // [sp+330h] [bp-878h]
  _DWORD v646[24]; // [sp+3C8h] [bp-7E0h] BYREF
  _DWORD v647[16]; // [sp+428h] [bp-780h] BYREF
  _DWORD v648[4]; // [sp+468h] [bp-740h] BYREF
  _DWORD v649[77]; // [sp+478h] [bp-730h] BYREF
  int v650; // [sp+5ACh] [bp-5FCh]
  int v651; // [sp+5B0h] [bp-5F8h] BYREF
  __int64 v652; // [sp+5B4h] [bp-5F4h]
  unsigned int v653; // [sp+5D8h] [bp-5D0h]
  int v654; // [sp+5DCh] [bp-5CCh]
  int v655; // [sp+5E0h] [bp-5C8h] BYREF
  __int64 v656; // [sp+5E4h] [bp-5C4h]
  _QWORD v657[3]; // [sp+608h] [bp-5A0h] BYREF
  int v658[6]; // [sp+620h] [bp-588h] BYREF

  v634 = a1;
  __disable_irq();
  v640 = a4;
  v625 = a3;
  v590 = a2;
  if ( !KdDebuggerNotPresent )
  {
    while ( 1 )
      ;
  }
  __enable_irq();
  if ( a4 )
  {
    if ( a2 != 3 && a2 != 5 )
      v590 = 0;
    v607 = a5 | 4;
  }
  else
  {
    if ( a2 == 3 || a2 == 5 )
      v590 = 0;
    v607 = a5;
  }
  __disable_irq();
  if ( !KdDebuggerNotPresent )
  {
    while ( 1 )
      ;
  }
  __enable_irq();
  v5 = KiInitData;
  if ( KiInitData != 11 )
  {
    v6 = FsRtlRemovePerStreamContextEx(3i64, 0x26C1ui64);
    if ( v6 )
    {
      if ( v6 == 1 )
      {
        v636 = -2147483490;
        v7 = __ROR4__(-2147483490, 31);
      }
      else
      {
        v636 = 634;
        v7 = __ROR4__(634, 1);
      }
    }
    else
    {
      v636 = 154817;
      v7 = __ROR4__(162304, 9);
    }
    KeBugCheckEx(v7, 2, 0, v5, 11);
  }
  v8 = 0;
  for ( i = &_ts_74; i != &_ts_z; v8 += v10 )
    v10 = *i++;
  v11 = 0;
  for ( j = &_ps_0; j != &_ps_z; v11 += v13 )
    v13 = *j++;
  if ( v8 != v11 )
  {
    v14 = FsRtlRemovePerStreamContextEx(3i64, 0x26C1ui64);
    if ( v14 )
    {
      if ( v14 == 1 )
      {
        v639 = -2147483490;
        v15 = __ROR4__(-2147483490, 31);
      }
      else
      {
        v639 = 634;
        v15 = __ROR4__(634, 1);
      }
    }
    else
    {
      v639 = 154817;
      v15 = __ROR4__(162304, 9);
    }
    KeBugCheckEx(v15, 12, v8, v11, 0);
  }
  v16 = (unsigned int)ExpPrefetchPushLock & 0xFFFFFFFE;
  if ( RtlPcToFileHeader((unsigned int)ExpPrefetchPushLock & 0xFFFFFFFE, &v637, (int)j, (int)ExpPrefetchPushLock) )
  {
    v17 = RtlImageNtHeader(v637);
    if ( v17 )
    {
      v18 = RtlSectionTableFromVirtualAddress(v17, v637, v16 - v637);
      if ( v18 )
      {
        v19 = *(_QWORD *)(v18 + 8);
        v20 = v637;
        __disable_irq();
        v21 = HIDWORD(v19) + v20;
        v22 = v16 - (HIDWORD(v19) + v20);
        v574 = v22;
        if ( !KdDebuggerNotPresent )
        {
          while ( 1 )
            ;
        }
        __enable_irq();
        v573 = ((unsigned int)sub_5FDC6C & 0xFFFFFFFE) - v21;
        v23 = ((unsigned int)CmpFlushLockedHives & 0xFFFFFFFE) - v21;
        v567 = v23;
        v565 = ((unsigned int)sub_5FD2A0 & 0xFFFFFFFE) - v21;
        v564 = ((unsigned int)sub_5FD658 & 0xFFFFFFFE) - v21;
        if ( v23 > 0xFFFF )
        {
          v24 = FsRtlRemovePerStreamContextEx(3i64, 0x26C1ui64);
          if ( v24 )
          {
            if ( v24 == 1 )
            {
              v608 = -2147483490;
              v25 = __ROR4__(-2147483490, 31);
            }
            else
            {
              v608 = 634;
              v25 = __ROR4__(634, 1);
            }
          }
          else
          {
            v608 = 154817;
            v25 = __ROR4__(162304, 9);
          }
          KeBugCheckEx(v25, 9, v23, v19, v22);
        }
        v26 = __mrc(15, 0, 9, 13, 0);
        v27 = v26 << 29;
        v28 = v26 ^ (v26 >> 3);
        v29 = 67117057i64 * (unsigned int)v28;
        v30 = 67117057 * v27 + 1880096896 * v28;
        v33 = 1880096896 * v27 + ((67117057i64 * v27 + 1880096896 * (unsigned __int64)(unsigned int)v28) >> 32);
        v32 = (1880096896i64 * v27 + ((67117057i64 * v27 + 1880096896 * (unsigned __int64)(unsigned int)v28) >> 32)) >> 32;
        v31 = v33;
        if ( (unsigned int)(v30 + HIDWORD(v29)) < HIDWORD(v29) )
        {
          v32 = (__PAIR64__(v32, v33) + 1) >> 32;
          v31 = v33 + 1;
        }
        HIDWORD(v34) = v32 ^ (v30 + HIDWORD(v29));
        LODWORD(v34) = v29 ^ v31;
        _rt_udiv64(10i64, v34);
        if ( v35 >= 2 )
        {
          v41 = 0;
        }
        else
        {
          v36 = __mrc(15, 0, 9, 13, 0);
          v37 = v36 << 29;
          v38 = v36 ^ (v36 >> 3);
          v39 = 67117057i64 * (unsigned int)v38;
          v40 = 1880096896 * v37 + ((67117057i64 * v37 + 1880096896 * (unsigned __int64)(unsigned int)v38) >> 32);
          if ( (0x7010008004002001i64 * __PAIR64__(v37, v38)) >> 32 < HIDWORD(v39) )
            ++v40;
          v41 = (v39 ^ v40) & 1;
        }
        __disable_irq();
        v588 = v41;
        if ( !KdDebuggerNotPresent )
        {
          while ( 1 )
            ;
        }
        __enable_irq();
        KiCacheRequiresLazyExecuteFlush = v41;
        dword_60E1C0[0] = (int)off_617994;
        memset(v658, 0, sizeof(v658));
        v42 = v658[4];
        v559 = v658[5];
        v571 = v658[1];
        v43 = v658[1];
        v555 = v658[4];
        v557 = v658[3];
        v44 = 0;
        v575 = v658[2];
        v562 = 0;
        v582 = v658[1];
        do
        {
          v45 = dword_60E1C0[v44];
          v46 = RtlLookupFunctionEntry(v45, &v651, 0);
          v650 = v46;
          if ( v46 )
          {
            v43 = v651;
            v47 = v46 + 8;
            v48 = (int *)&v644;
            v582 = v651;
            LODWORD(v652) = v46 + 8;
            HIDWORD(v652) = &v644;
            v649[76] = v45;
          }
          else
          {
            v48 = (int *)HIDWORD(v652);
            v47 = v652;
          }
          v49 = v559;
          while ( v46 && v46 != v47 )
          {
            v650 = v46 + 8;
            *v48 = v46;
            v50 = *v644;
            v51 = *(_DWORD *)v644 & 0xFFFFFFFE;
            if ( (*((_DWORD *)v644 + 1) & 3) != 0 )
              HIDWORD(v50) = (HIDWORD(v50) >> 2) & 0x7FF;
            else
              HIDWORD(v50) = *(_DWORD *)(HIDWORD(v50) + v43) & 0x3FFFF;
            v52 = ((v50 + 2 * HIDWORD(v50)) & 0xFFFFFFFE) - v51;
            v53 = (v51 + v43) & 0xFFFFF000;
            v569 = v53;
            v555 = v42 + 1;
            v559 = v49 + v52;
            v579 = v51 + v43 + v52;
            do
            {
              v54 = (v53 >> 10) & 0x3FFFFC;
              v55 = 0;
              v56 = 0;
              v57 = v649;
              do
              {
                if ( v55 )
                {
                  v58 = (((unsigned int)(v54 - 1073741821) >> 10) & 0x3FFFFC) - 0x40000000;
                }
                else
                {
                  v58 = v54 - 0x40000000;
                  if ( (*(_DWORD *)((((unsigned int)(v54 - 0x40000000) >> 10) & 0x3FFFFC) - 0x40000000) & 0x400) != 0 )
                    v58 = 0;
                }
                if ( v58 )
                {
                  *v57++ = v58;
                  ++v56;
                }
                ++v55;
              }
              while ( v55 < 2 );
              v49 = v559;
              if ( v56 )
              {
                v59 = v557;
                v60 = &v649[v56];
                do
                {
                  v61 = *--v60;
                  v62 = v571;
                  v63 = 0;
                  --v56;
                  if ( v59 )
                  {
                    v64 = (_DWORD *)v571;
                    do
                    {
                      if ( v61 == *v64 )
                        break;
                      ++v63;
                      ++v64;
                    }
                    while ( v63 < v59 );
                  }
                  if ( v63 == v59 )
                  {
                    if ( v59 == v575 )
                    {
                      v575 = 2 * (v575 + 32);
                      v65 = __mrc(15, 0, 9, 13, 0);
                      v66 = v65 << 29;
                      v67 = v65 ^ (v65 >> 3);
                      v68 = 67117057i64 * (unsigned int)v67;
                      v69 = 1880096896 * v67 + 67117057 * v66;
                      v72 = 1880096896 * v66
                          + ((1880096896i64 * (unsigned int)v67 + 67117057 * (unsigned __int64)v66) >> 32);
                      v71 = (1880096896i64 * v66
                           + ((1880096896i64 * (unsigned int)v67 + 67117057 * (unsigned __int64)v66) >> 32)) >> 32;
                      v70 = v72;
                      if ( (unsigned int)(v69 + HIDWORD(v68)) < HIDWORD(v68) )
                      {
                        v71 = (__PAIR64__(v71, v72) + 1) >> 32;
                        v70 = v72 + 1;
                      }
                      HIDWORD(v73) = v71 ^ (v69 + HIDWORD(v68));
                      LODWORD(v73) = v68 ^ v70;
                      switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v73) )
                      {
                        case 0u:
                          if ( !FsRtlRemovePerStreamContextEx(3i64, 0i64) )
                          {
                            v75 = -795291432;
                            goto LABEL_80;
                          }
                          v74 = 1665295171;
                          goto LABEL_135;
                        case 1u:
                          v77 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
                          if ( !v77 )
                          {
                            v611 = -1262057781;
                            v75 = -1262057782;
                            goto LABEL_87;
                          }
                          if ( v77 == 1 )
                          {
                            v76 = 31;
                            v611 = -1297272415;
                            v75 = -1297272415;
                            break;
                          }
                          v611 = -894122362;
                          v75 = -894122362;
                          goto LABEL_131;
                        case 2u:
                          v78 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
                          if ( v78 )
                          {
                            if ( v78 == 1 )
                            {
                              v75 = -665102064;
                              goto LABEL_125;
                            }
                            v76 = 2;
                            v75 = -2051698419;
                          }
                          else
                          {
                            v76 = 12;
                            v75 = -700172778;
                          }
                          break;
                        case 3u:
                          v79 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
                          if ( v79 )
                          {
                            if ( v79 == 1 )
                            {
                              v76 = 29;
                              v630 = -1907430904;
                              v75 = -1907430904;
                            }
                            else
                            {
                              v76 = 3;
                              v630 = -1816493533;
                              v75 = -1816493533;
                            }
                          }
                          else
                          {
                            v76 = 15;
                            v630 = -1474152136;
                            v75 = -1474152133;
                          }
                          break;
                        case 4u:
                          v80 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
                          if ( v80 )
                          {
                            if ( v80 == 1 )
                            {
                              v76 = 28;
                              v75 = 1728537748;
                            }
                            else
                            {
                              v76 = 4;
                              v75 = 124032103;
                            }
                          }
                          else
                          {
                            v76 = 18;
                            v75 = 622445017;
                          }
                          break;
                        case 5u:
                          v81 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
                          if ( v81 )
                          {
                            if ( v81 == 1 )
                            {
                              v613 = 2068456210;
                              v75 = 2068456210;
                              goto LABEL_119;
                            }
                            v76 = 5;
                            v613 = 680282605;
                            v75 = 680282605;
                          }
                          else
                          {
                            v76 = 21;
                            v613 = 1240279177;
                            v75 = 1240279180;
                          }
                          break;
                        case 6u:
                          v82 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
                          if ( !v82 )
                          {
                            v75 = 1314342516;
                            goto LABEL_113;
                          }
                          if ( v82 == 1 )
                          {
                            v76 = 26;
                            v75 = 962402769;
                          }
                          else
                          {
                            v75 = -778234987;
LABEL_80:
                            v76 = 6;
                          }
                          break;
                        case 7u:
                          v83 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
                          if ( v83 )
                          {
                            if ( v83 == 1 )
                            {
                              v76 = 25;
                              v643 = -2100910376;
                              v75 = -2100910376;
                            }
                            else
                            {
                              v76 = 7;
                              v643 = -1447681871;
                              v75 = -1447681871;
                            }
                          }
                          else
                          {
                            v643 = 186293093;
                            v75 = 186293090;
LABEL_119:
                            v76 = 27;
                          }
                          break;
                        case 8u:
                          v84 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
                          if ( v84 )
                          {
                            if ( v84 == 1 )
                            {
                              v75 = 1094870118;
LABEL_113:
                              v76 = 24;
                            }
                            else
                            {
                              v76 = 8;
                              v75 = 1684422978;
                            }
                          }
                          else
                          {
                            v75 = 1352210832;
LABEL_125:
                            v76 = 30;
                          }
                          break;
                        case 9u:
                          v85 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
                          if ( v85 )
                          {
                            if ( v85 == 1 )
                            {
                              v76 = 23;
                              v615 = -1557388889;
                              v75 = -1557388889;
                            }
                            else
                            {
                              v615 = -2036429648;
                              v75 = -2036429648;
LABEL_87:
                              v76 = 9;
                            }
                          }
                          else
                          {
                            v615 = -1333354875;
                            v75 = -1333354868;
LABEL_131:
                            v76 = 1;
                          }
                          break;
                        case 0xAu:
                          v86 = __mrc(15, 0, 9, 13, 0);
                          v87 = v86 << 29;
                          v88 = v86 ^ (v86 >> 3);
                          v89 = 67117057i64 * (unsigned int)v88;
                          v90 = 1880096896 * v87
                              + ((67117057i64 * v87 + 1880096896 * (unsigned __int64)(unsigned int)v88) >> 32);
                          if ( (0x7010008004002001i64 * __PAIR64__(v87, v88)) >> 32 < HIDWORD(v89) )
                            ++v90;
                          v91 = ((unsigned int)v89 ^ v90) >> 5;
                          v92 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v89 ^ (unsigned __int64)v90);
                          v93 = v91 >> 5;
                          v94 = FsRtlRemovePerStreamContextEx(26i64, v91);
                          v95 = FsRtlRemovePerStreamContextEx(26i64, v91 >> 5);
                          v74 = ((v92 + 97) << 24) | ((v95 + 97) << 8) | ((v94 + 65) << 16) | (FsRtlRemovePerStreamContextEx(
                                                                                                 26i64,
                                                                                                 v93 >> 5)
                                                                                             + 65);
                          goto LABEL_135;
                      }
                      v74 = __ROR4__(v75, v76);
LABEL_135:
                      v96 = ExAllocatePoolWithTag(512, 4 * v575, v74);
                      if ( !v96 )
                        return 0;
                      if ( v571 )
                      {
                        v97 = (int *)v571;
                        v98 = (char *)v96;
                        v99 = 4 * v557;
                        if ( (unsigned int)(4 * v557) >= 4 )
                        {
                          v100 = v99 >> 2;
                          do
                          {
                            v101 = *v97++;
                            v99 -= 4;
                            *(_DWORD *)v98 = v101;
                            v98 += 4;
                            --v100;
                          }
                          while ( v100 );
                        }
                        if ( v99 )
                        {
                          v102 = v98 - (char *)v97;
                          do
                          {
                            *((_BYTE *)v97 + v102) = *(_BYTE *)v97;
                            v97 = (int *)((char *)v97 + 1);
                            --v99;
                          }
                          while ( v99 );
                        }
                        ExFreePool(v571);
                      }
                      v62 = v96;
                      v59 = v557;
                      v49 = v559;
                      v571 = v96;
                    }
                    v103 = (_DWORD *)(v62 + 4 * v59++);
                    v49 += 8;
                    v557 = v59;
                    v559 = v49;
                    *v103 = v61;
                  }
                }
                while ( v56 );
              }
              v53 = v569 + 4096;
              v569 = v53;
            }
            while ( v53 < v579 );
            v48 = (int *)HIDWORD(v652);
            v47 = v652;
            v46 = v650;
            v43 = v582;
            v42 = v555;
          }
          v44 = v562 + 1;
          v562 = v44;
        }
        while ( v44 < 8 );
        v104 = (unsigned int)&off_617994 & 0xFFFFF000;
        v580 = (unsigned int)&off_617994 & 0xFFFFF000;
        v560 = v49 + 4;
        do
        {
          v105 = (v104 >> 10) & 0x3FFFFC;
          v106 = 0;
          v107 = 0;
          v108 = v647;
          do
          {
            if ( v106 )
            {
              v109 = (((unsigned int)(v105 - 1073741821) >> 10) & 0x3FFFFC) - 0x40000000;
            }
            else
            {
              v109 = v105 - 0x40000000;
              if ( (*(_DWORD *)((((unsigned int)(v105 - 0x40000000) >> 10) & 0x3FFFFC) - 0x40000000) & 0x400) != 0 )
                v109 = 0;
            }
            if ( v109 )
            {
              *v108++ = v109;
              ++v107;
            }
            ++v106;
          }
          while ( v106 < 2 );
          v110 = v560;
          if ( v107 )
          {
            v111 = v557;
            v112 = &v647[v107];
            do
            {
              v113 = *--v112;
              v114 = v571;
              v115 = 0;
              --v107;
              if ( v111 )
              {
                v116 = (_DWORD *)v571;
                do
                {
                  if ( v113 == *v116 )
                    break;
                  ++v115;
                  ++v116;
                }
                while ( v115 < v111 );
              }
              if ( v115 == v111 )
              {
                if ( v111 == v575 )
                {
                  v575 = 2 * (v575 + 32);
                  v117 = __mrc(15, 0, 9, 13, 0);
                  v118 = v117 << 29;
                  v119 = v117 ^ (v117 >> 3);
                  v120 = 67117057i64 * (unsigned int)v119;
                  v121 = 1880096896 * v119 + 67117057 * v118;
                  v124 = 1880096896 * v118
                       + ((1880096896i64 * (unsigned int)v119 + 67117057 * (unsigned __int64)v118) >> 32);
                  v123 = (1880096896i64 * v118
                        + ((1880096896i64 * (unsigned int)v119 + 67117057 * (unsigned __int64)v118) >> 32)) >> 32;
                  v122 = v124;
                  if ( (unsigned int)(v121 + HIDWORD(v120)) < HIDWORD(v120) )
                  {
                    v123 = (__PAIR64__(v123, v124) + 1) >> 32;
                    v122 = v124 + 1;
                  }
                  HIDWORD(v125) = v123 ^ (v121 + HIDWORD(v120));
                  LODWORD(v125) = v120 ^ v122;
                  switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v125) )
                  {
                    case 0u:
                      if ( !FsRtlRemovePerStreamContextEx(3i64, 0i64) )
                      {
                        v127 = -795291432;
                        goto LABEL_173;
                      }
                      v126 = 1665295171;
                      goto LABEL_228;
                    case 1u:
                      v129 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
                      if ( !v129 )
                      {
                        v631 = -1262057781;
                        v127 = -1262057782;
                        goto LABEL_180;
                      }
                      if ( v129 == 1 )
                      {
                        v128 = 31;
                        v631 = -1297272415;
                        v127 = -1297272415;
                        break;
                      }
                      v631 = -894122362;
                      v127 = -894122362;
                      goto LABEL_224;
                    case 2u:
                      v130 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
                      if ( v130 )
                      {
                        if ( v130 == 1 )
                        {
                          v127 = -665102064;
                          goto LABEL_218;
                        }
                        v128 = 2;
                        v127 = -2051698419;
                      }
                      else
                      {
                        v128 = 12;
                        v127 = -700172778;
                      }
                      break;
                    case 3u:
                      v131 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
                      if ( v131 )
                      {
                        if ( v131 == 1 )
                        {
                          v128 = 29;
                          v617 = -1907430904;
                          v127 = -1907430904;
                        }
                        else
                        {
                          v128 = 3;
                          v617 = -1816493533;
                          v127 = -1816493533;
                        }
                      }
                      else
                      {
                        v128 = 15;
                        v617 = -1474152136;
                        v127 = -1474152133;
                      }
                      break;
                    case 4u:
                      v132 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
                      if ( v132 )
                      {
                        if ( v132 == 1 )
                        {
                          v128 = 28;
                          v127 = 1728537748;
                        }
                        else
                        {
                          v128 = 4;
                          v127 = 124032103;
                        }
                      }
                      else
                      {
                        v128 = 18;
                        v127 = 622445017;
                      }
                      break;
                    case 5u:
                      v133 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
                      if ( v133 )
                      {
                        if ( v133 == 1 )
                        {
                          v638 = 2068456210;
                          v127 = 2068456210;
                          goto LABEL_212;
                        }
                        v128 = 5;
                        v638 = 680282605;
                        v127 = 680282605;
                      }
                      else
                      {
                        v128 = 21;
                        v638 = 1240279177;
                        v127 = 1240279180;
                      }
                      break;
                    case 6u:
                      v134 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
                      if ( !v134 )
                      {
                        v127 = 1314342516;
                        goto LABEL_206;
                      }
                      if ( v134 == 1 )
                      {
                        v128 = 26;
                        v127 = 962402769;
                      }
                      else
                      {
                        v127 = -778234987;
LABEL_173:
                        v128 = 6;
                      }
                      break;
                    case 7u:
                      v135 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
                      if ( v135 )
                      {
                        if ( v135 == 1 )
                        {
                          v128 = 25;
                          v619 = -2100910376;
                          v127 = -2100910376;
                        }
                        else
                        {
                          v128 = 7;
                          v619 = -1447681871;
                          v127 = -1447681871;
                        }
                      }
                      else
                      {
                        v619 = 186293093;
                        v127 = 186293090;
LABEL_212:
                        v128 = 27;
                      }
                      break;
                    case 8u:
                      v136 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
                      if ( v136 )
                      {
                        if ( v136 == 1 )
                        {
                          v127 = 1094870118;
LABEL_206:
                          v128 = 24;
                        }
                        else
                        {
                          v128 = 8;
                          v127 = 1684422978;
                        }
                      }
                      else
                      {
                        v127 = 1352210832;
LABEL_218:
                        v128 = 30;
                      }
                      break;
                    case 9u:
                      v137 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
                      if ( v137 )
                      {
                        if ( v137 == 1 )
                        {
                          v128 = 23;
                          v632 = -1557388889;
                          v127 = -1557388889;
                        }
                        else
                        {
                          v632 = -2036429648;
                          v127 = -2036429648;
LABEL_180:
                          v128 = 9;
                        }
                      }
                      else
                      {
                        v632 = -1333354875;
                        v127 = -1333354868;
LABEL_224:
                        v128 = 1;
                      }
                      break;
                    case 0xAu:
                      v138 = __mrc(15, 0, 9, 13, 0);
                      v139 = v138 << 29;
                      v140 = v138 ^ (v138 >> 3);
                      v141 = 67117057i64 * (unsigned int)v140;
                      v142 = 1880096896 * v139
                           + ((67117057i64 * v139 + 1880096896 * (unsigned __int64)(unsigned int)v140) >> 32);
                      if ( (0x7010008004002001i64 * __PAIR64__(v139, v140)) >> 32 < HIDWORD(v141) )
                        ++v142;
                      v143 = ((unsigned int)v141 ^ v142) >> 5;
                      v144 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v141 ^ (unsigned __int64)v142);
                      v145 = v143 >> 5;
                      v146 = FsRtlRemovePerStreamContextEx(26i64, v143);
                      v147 = FsRtlRemovePerStreamContextEx(26i64, v143 >> 5);
                      v126 = ((v144 + 97) << 24) | ((v147 + 97) << 8) | ((v146 + 65) << 16) | (FsRtlRemovePerStreamContextEx(
                                                                                                 26i64,
                                                                                                 v145 >> 5)
                                                                                             + 65);
                      goto LABEL_228;
                  }
                  v126 = __ROR4__(v127, v128);
LABEL_228:
                  v148 = ExAllocatePoolWithTag(512, 4 * v575, v126);
                  v149 = v148;
                  if ( !v148 )
                    return 0;
                  if ( v571 )
                  {
                    v150 = (int *)v571;
                    v151 = (char *)v148;
                    v152 = 4 * v557;
                    if ( (unsigned int)(4 * v557) >= 4 )
                    {
                      v153 = v152 >> 2;
                      do
                      {
                        v154 = *v150++;
                        v152 -= 4;
                        *(_DWORD *)v151 = v154;
                        v151 += 4;
                        --v153;
                      }
                      while ( v153 );
                    }
                    if ( v152 )
                    {
                      v155 = v151 - (char *)v150;
                      do
                      {
                        *((_BYTE *)v150 + v155) = *(_BYTE *)v150;
                        v150 = (int *)((char *)v150 + 1);
                        --v152;
                      }
                      while ( v152 );
                    }
                    ExFreePool(v571);
                  }
                  v114 = v149;
                  v111 = v557;
                  v110 = v560;
                  v571 = v149;
                }
                v156 = (_DWORD *)(v114 + 4 * v111++);
                v110 += 8;
                v557 = v111;
                v560 = v110;
                *v156 = v113;
              }
            }
            while ( v107 );
          }
          v104 = v580 + 4096;
          v580 = v104;
        }
        while ( v104 < (unsigned int)algn_617998 );
        v157 = v555;
        __disable_irq();
        v158 = v110 + 8 * (v157 + 2);
        if ( !KdDebuggerNotPresent )
        {
          while ( 1 )
            ;
        }
        __enable_irq();
        v159 = v19 + ((v158 + 1107) & 0xFFFFFFFC);
        v581 = (v158 + 1107) & 0xFFFFFFFC;
        v160 = __mrc(15, 0, 9, 13, 0);
        v161 = v160 << 29;
        v162 = v160 ^ (v160 >> 3);
        v163 = 67117057i64 * (unsigned int)v162;
        v164 = 67117057 * v161 + 1880096896 * v162;
        v167 = 1880096896 * v161 + ((67117057i64 * v161 + 1880096896 * (unsigned __int64)(unsigned int)v162) >> 32);
        v166 = (1880096896i64 * v161 + ((67117057i64 * v161 + 1880096896 * (unsigned __int64)(unsigned int)v162) >> 32)) >> 32;
        v165 = v167;
        if ( (unsigned int)(v164 + HIDWORD(v163)) < HIDWORD(v163) )
        {
          v166 = (__PAIR64__(v166, v167) + 1) >> 32;
          v165 = v167 + 1;
        }
        HIDWORD(v168) = v166 ^ (v164 + HIDWORD(v163));
        LODWORD(v168) = v163 ^ v165;
        v169 = v159 + FsRtlRemovePerStreamContextEx(2048i64, v168);
        v570 = v169;
        v170 = __mrc(15, 0, 9, 13, 0);
        v171 = v170 << 29;
        v172 = v170 ^ (v170 >> 3);
        v173 = 67117057i64 * (unsigned int)v172;
        v174 = 1880096896 * v172 + 67117057 * v171;
        v177 = 1880096896 * v171 + ((1880096896i64 * (unsigned int)v172 + 67117057 * (unsigned __int64)v171) >> 32);
        v176 = (1880096896i64 * v171 + ((1880096896i64 * (unsigned int)v172 + 67117057 * (unsigned __int64)v171) >> 32)) >> 32;
        v175 = v177;
        if ( (unsigned int)(v174 + HIDWORD(v173)) < HIDWORD(v173) )
        {
          v176 = (__PAIR64__(v176, v177) + 1) >> 32;
          v175 = v177 + 1;
        }
        HIDWORD(v178) = v176 ^ (v174 + HIDWORD(v173));
        LODWORD(v178) = v173 ^ v175;
        v179 = FsRtlRemovePerStreamContextEx(2048i64, v178) + 3;
        v583 = v179;
        v180 = __mrc(15, 0, 9, 13, 0);
        v181 = v180 << 29;
        v182 = v180 ^ (v180 >> 3);
        v183 = 67117057i64 * (unsigned int)v182;
        v184 = 1880096896 * v182 + 67117057 * v181;
        v187 = 1880096896 * v181 + ((1880096896i64 * (unsigned int)v182 + 67117057 * (unsigned __int64)v181) >> 32);
        v186 = (1880096896i64 * v181 + ((1880096896i64 * (unsigned int)v182 + 67117057 * (unsigned __int64)v181) >> 32)) >> 32;
        v185 = v187;
        if ( (unsigned int)(v184 + HIDWORD(v183)) < HIDWORD(v183) )
        {
          v186 = (__PAIR64__(v186, v187) + 1) >> 32;
          v185 = v187 + 1;
        }
        HIDWORD(v188) = v186 ^ (v184 + HIDWORD(v183));
        LODWORD(v188) = v183 ^ v185;
        v189 = FsRtlRemovePerStreamContextEx((unsigned int)(v179 + 1), v188) & 0xFFFFFFFC;
        v190 = __mrc(15, 0, 9, 13, 0);
        v191 = v190 << 29;
        v192 = v190 ^ (v190 >> 3);
        v193 = 67117057i64 * (unsigned int)v192;
        v194 = 1880096896 * v192 + 67117057 * v191;
        v197 = 1880096896 * v191 + ((1880096896i64 * (unsigned int)v192 + 67117057 * (unsigned __int64)v191) >> 32);
        v196 = (1880096896i64 * v191 + ((1880096896i64 * (unsigned int)v192 + 67117057 * (unsigned __int64)v191) >> 32)) >> 32;
        v195 = v197;
        if ( (unsigned int)(v194 + HIDWORD(v193)) < HIDWORD(v193) )
        {
          v196 = (__PAIR64__(v196, v197) + 1) >> 32;
          v195 = v197 + 1;
        }
        HIDWORD(v198) = v196 ^ (v194 + HIDWORD(v193));
        LODWORD(v198) = v193 ^ v195;
        switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v198) )
        {
          case 0u:
            if ( !FsRtlRemovePerStreamContextEx(3i64, 0i64) )
            {
              v200 = -795291432;
              goto LABEL_255;
            }
            v199 = 1665295171;
            goto LABEL_310;
          case 1u:
            v202 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
            if ( !v202 )
            {
              v621 = -1262057781;
              v200 = -1262057782;
              goto LABEL_262;
            }
            if ( v202 == 1 )
            {
              v201 = 31;
              v621 = -1297272415;
              v200 = -1297272415;
              break;
            }
            v621 = -894122362;
            v200 = -894122362;
            goto LABEL_306;
          case 2u:
            v203 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
            if ( v203 )
            {
              if ( v203 == 1 )
              {
                v200 = -665102064;
                goto LABEL_300;
              }
              v201 = 2;
              v200 = -2051698419;
            }
            else
            {
              v201 = 12;
              v200 = -700172778;
            }
            break;
          case 3u:
            v204 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
            if ( v204 )
            {
              if ( v204 == 1 )
              {
                v201 = 29;
                v642 = -1907430904;
                v200 = -1907430904;
              }
              else
              {
                v201 = 3;
                v642 = -1816493533;
                v200 = -1816493533;
              }
            }
            else
            {
              v201 = 15;
              v642 = -1474152136;
              v200 = -1474152133;
            }
            break;
          case 4u:
            v205 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
            if ( v205 )
            {
              if ( v205 == 1 )
              {
                v201 = 28;
                v200 = 1728537748;
              }
              else
              {
                v201 = 4;
                v200 = 124032103;
              }
            }
            else
            {
              v201 = 18;
              v200 = 622445017;
            }
            break;
          case 5u:
            v206 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
            if ( v206 )
            {
              if ( v206 == 1 )
              {
                v623 = 2068456210;
                v200 = 2068456210;
                goto LABEL_294;
              }
              v201 = 5;
              v623 = 680282605;
              v200 = 680282605;
            }
            else
            {
              v201 = 21;
              v623 = 1240279177;
              v200 = 1240279180;
            }
            break;
          case 6u:
            v207 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
            if ( !v207 )
            {
              v200 = 1314342516;
              goto LABEL_288;
            }
            if ( v207 == 1 )
            {
              v201 = 26;
              v200 = 962402769;
            }
            else
            {
              v200 = -778234987;
LABEL_255:
              v201 = 6;
            }
            break;
          case 7u:
            v208 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
            if ( v208 )
            {
              if ( v208 == 1 )
              {
                v201 = 25;
                v633 = -2100910376;
                v200 = -2100910376;
              }
              else
              {
                v201 = 7;
                v633 = -1447681871;
                v200 = -1447681871;
              }
            }
            else
            {
              v633 = 186293093;
              v200 = 186293090;
LABEL_294:
              v201 = 27;
            }
            break;
          case 8u:
            v209 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
            if ( v209 )
            {
              if ( v209 == 1 )
              {
                v200 = 1094870118;
LABEL_288:
                v201 = 24;
              }
              else
              {
                v201 = 8;
                v200 = 1684422978;
              }
            }
            else
            {
              v200 = 1352210832;
LABEL_300:
              v201 = 30;
            }
            break;
          case 9u:
            v210 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
            if ( v210 )
            {
              if ( v210 == 1 )
              {
                v201 = 23;
                v624 = -1557388889;
                v200 = -1557388889;
              }
              else
              {
                v624 = -2036429648;
                v200 = -2036429648;
LABEL_262:
                v201 = 9;
              }
            }
            else
            {
              v624 = -1333354875;
              v200 = -1333354868;
LABEL_306:
              v201 = 1;
            }
            break;
          case 0xAu:
            v211 = __mrc(15, 0, 9, 13, 0);
            v212 = v211 << 29;
            v213 = v211 ^ (v211 >> 3);
            v214 = 67117057i64 * (unsigned int)v213;
            v215 = 1880096896 * v212 + ((67117057i64 * v212 + 1880096896 * (unsigned __int64)(unsigned int)v213) >> 32);
            if ( (0x7010008004002001i64 * __PAIR64__(v212, v213)) >> 32 < HIDWORD(v214) )
              ++v215;
            v216 = ((unsigned int)v214 ^ v215) >> 5;
            v217 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v214 ^ (unsigned __int64)v215);
            v218 = v216 >> 5;
            v219 = FsRtlRemovePerStreamContextEx(26i64, v216);
            v220 = FsRtlRemovePerStreamContextEx(26i64, v216 >> 5);
            v199 = ((v217 + 97) << 24) | ((v220 + 97) << 8) | ((v219 + 65) << 16) | (FsRtlRemovePerStreamContextEx(
                                                                                       26i64,
                                                                                       v218 >> 5)
                                                                                   + 65);
            goto LABEL_310;
        }
        v199 = __ROR4__(v200, v201);
LABEL_310:
        v221 = ExAllocatePoolWithTag(512, v179 + v169, v199);
        v576 = v221;
        if ( v221 )
        {
          v222 = (_DWORD *)v221;
          v223 = v189;
          if ( v189 >= 8 )
          {
            v224 = v189 >> 3;
            do
            {
              v225 = __mrc(15, 0, 9, 13, 0);
              v226 = v225 << 29;
              v227 = v225 ^ (v225 >> 3);
              v228 = 67117057i64 * (unsigned int)v227;
              v229 = 1880096896i64 * (unsigned int)v227 + 67117057i64 * v226;
              v230 = (1880096896i64 * v226 + (unsigned __int64)HIDWORD(v229)) >> 32;
              v231 = 1880096896 * v226 + HIDWORD(v229);
              if ( (unsigned int)(v229 + HIDWORD(v228)) < HIDWORD(v228) )
                v230 = (__PAIR64__(v230, v231++) + 1) >> 32;
              *v222 = v231 ^ v228;
              v222[1] = v230 ^ (v229 + HIDWORD(v228));
              v222 += 2;
              --v224;
              v223 -= 8;
            }
            while ( v224 );
            v179 = v583;
          }
          if ( v223 )
          {
            v232 = __mrc(15, 0, 9, 13, 0);
            v233 = v232 << 29;
            v234 = v232 ^ (v232 >> 3);
            v235 = 67117057i64 * (unsigned int)v234;
            v236 = 1880096896i64 * (unsigned int)v234 + 67117057i64 * v233;
            v237 = (1880096896i64 * v233 + (unsigned __int64)HIDWORD(v236)) >> 32;
            v238 = 1880096896 * v233 + HIDWORD(v236);
            if ( (unsigned int)(v236 + HIDWORD(v235)) < HIDWORD(v235) )
              v237 = (__PAIR64__(v237, v238++) + 1) >> 32;
            v239 = v235 ^ v238;
            v240 = (v236 + HIDWORD(v235)) ^ v237;
            do
            {
              *(_BYTE *)v222 = v239;
              v222 = (_DWORD *)((char *)v222 + 1);
              v239 = FsRtlPrivateResetHighestLockOffset(v239, v240, 8);
              --v223;
            }
            while ( v223 );
          }
          v241 = v179 - v189;
          v242 = v576 + v189;
          v584 = v576 + v189;
          v243 = v179 - v189 >= 8;
          v244 = (_DWORD *)(v576 + v189 + v570);
          if ( v243 )
          {
            v245 = v241 >> 3;
            do
            {
              v246 = __mrc(15, 0, 9, 13, 0);
              v247 = v246 << 29;
              v248 = v246 ^ (v246 >> 3);
              v249 = 67117057i64 * (unsigned int)v248;
              v250 = 1880096896i64 * (unsigned int)v248 + 67117057i64 * v247;
              v251 = (1880096896i64 * v247 + (unsigned __int64)HIDWORD(v250)) >> 32;
              v252 = 1880096896 * v247 + HIDWORD(v250);
              if ( (unsigned int)(v250 + HIDWORD(v249)) < HIDWORD(v249) )
                v251 = (__PAIR64__(v251, v252++) + 1) >> 32;
              *v244 = v252 ^ v249;
              v244[1] = v251 ^ (v250 + HIDWORD(v249));
              v241 -= 8;
              v244 += 2;
              --v245;
            }
            while ( v245 );
            v242 = v584;
          }
          if ( v241 )
          {
            v253 = __mrc(15, 0, 9, 13, 0);
            v254 = v253 << 29;
            v255 = v253 ^ (v253 >> 3);
            v256 = 67117057i64 * (unsigned int)v255;
            v257 = 1880096896i64 * (unsigned int)v255 + 67117057i64 * v254;
            v258 = (1880096896i64 * v254 + (unsigned __int64)HIDWORD(v257)) >> 32;
            v259 = 1880096896 * v254 + HIDWORD(v257);
            if ( (unsigned int)(v257 + HIDWORD(v256)) < HIDWORD(v256) )
              v258 = (__PAIR64__(v258, v259++) + 1) >> 32;
            v260 = v256 ^ v259;
            v261 = (v257 + HIDWORD(v256)) ^ v258;
            do
            {
              *(_BYTE *)v244 = v260;
              v244 = (_DWORD *)((char *)v244 + 1);
              v260 = FsRtlPrivateResetHighestLockOffset(v260, v261, 8);
              --v241;
            }
            while ( v241 );
          }
          if ( v242 )
          {
            memset((_BYTE *)v242, 0, v19 + v581);
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            *(_DWORD *)(v242 + 1080) = sub_5FD2A0;
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            v262 = v242 + 1104;
            dword_60E1C0[0] = (int)off_617994;
            memset(v657, 0, sizeof(v657));
            v263 = v657[2];
            v264 = 0;
            v556 = v657[2];
            v566 = HIDWORD(v657[0]);
            v265 = HIDWORD(v657[0]);
            v561 = HIDWORD(v657[1]);
            v572 = 0;
            v568 = HIDWORD(v657[0]);
            v563 = v657[1];
            do
            {
              v266 = dword_60E1C0[v264];
              v267 = RtlLookupFunctionEntry(v266, &v655, 0);
              v654 = v267;
              if ( v267 )
              {
                v265 = v655;
                v268 = v267 + 8;
                v269 = v589;
                v568 = v655;
                LODWORD(v656) = v267 + 8;
                HIDWORD(v656) = v589;
                v653 = v266;
              }
              else
              {
                v269 = (int *)HIDWORD(v656);
                v268 = v656;
              }
              v270 = HIDWORD(v556);
              while ( v267 && v267 != v268 )
              {
                v654 = v267 + 8;
                *v269 = v267;
                v271 = *(_QWORD *)v589[0];
                v272 = *(_DWORD *)v589[0] & 0xFFFFFFFE;
                if ( (*(_DWORD *)(v589[0] + 4) & 3) != 0 )
                  HIDWORD(v271) = (HIDWORD(v271) >> 2) & 0x7FF;
                else
                  HIDWORD(v271) = *(_DWORD *)(HIDWORD(v271) + v265) & 0x3FFFF;
                v273 = ((v271 + 2 * HIDWORD(v271)) & 0xFFFFFFFE) - v272;
                v274 = v272 + v265;
                if ( v262 )
                  *(_QWORD *)(v262 + 8 * (v263 + 1)) = *(_QWORD *)&v274;
                v275 = v274 & 0xFFFFF000;
                v585 = v274 & 0xFFFFF000;
                v586 = v273 + v274;
                LODWORD(v556) = v263 + 1;
                HIDWORD(v556) = v270 + v273;
                do
                {
                  v276 = (v275 >> 10) & 0x3FFFFC;
                  v277 = 0;
                  v278 = v646;
                  v279 = 0;
                  do
                  {
                    if ( v277 )
                    {
                      v280 = (((unsigned int)(v276 - 1073741821) >> 10) & 0x3FFFFC) - 0x40000000;
                    }
                    else
                    {
                      v280 = v276 - 0x40000000;
                      if ( (*(_DWORD *)((((unsigned int)(v276 - 0x40000000) >> 10) & 0x3FFFFC) - 0x40000000) & 0x400) != 0 )
                        v280 = 0;
                    }
                    if ( v280 )
                    {
                      *v278++ = v280;
                      ++v279;
                    }
                    ++v277;
                  }
                  while ( v277 < 2 );
                  v270 = HIDWORD(v556);
                  if ( v279 )
                  {
                    v281 = v561;
                    v282 = &v646[v279];
                    do
                    {
                      v283 = v282 - 1;
                      v284 = *v283;
                      v285 = v566;
                      v286 = 0;
                      v577 = v283;
                      --v279;
                      if ( v281 )
                      {
                        v287 = (_DWORD *)v566;
                        do
                        {
                          if ( v284 == *v287 )
                            break;
                          ++v286;
                          ++v287;
                        }
                        while ( v286 < v281 );
                      }
                      if ( v286 == v281 )
                      {
                        if ( v281 == v563 )
                        {
                          v563 = 2 * (v563 + 32);
                          v288 = __mrc(15, 0, 9, 13, 0);
                          v289 = v288 << 29;
                          v290 = v288 ^ (v288 >> 3);
                          v291 = 67117057i64 * (unsigned int)v290;
                          v292 = 1880096896 * v290 + 67117057 * v289;
                          v295 = 1880096896 * v289
                               + ((1880096896i64 * (unsigned int)v290 + 67117057 * (unsigned __int64)v289) >> 32);
                          v294 = (1880096896i64 * v289
                                + ((1880096896i64 * (unsigned int)v290 + 67117057 * (unsigned __int64)v289) >> 32)) >> 32;
                          v293 = v295;
                          if ( (unsigned int)(v292 + HIDWORD(v291)) < HIDWORD(v291) )
                          {
                            v294 = (__PAIR64__(v294, v295) + 1) >> 32;
                            v293 = v295 + 1;
                          }
                          HIDWORD(v296) = v294 ^ (v292 + HIDWORD(v291));
                          LODWORD(v296) = v291 ^ v293;
                          switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v296) )
                          {
                            case 0u:
                              if ( !FsRtlRemovePerStreamContextEx(3i64, 0i64) )
                              {
                                v591 = -795291432;
                                v298 = -795291432;
                                goto LABEL_374;
                              }
                              v591 = 1665295171;
                              v297 = 1665295171;
                              goto LABEL_429;
                            case 1u:
                              v300 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
                              if ( !v300 )
                              {
                                v626 = -1262057781;
                                v298 = -1262057782;
                                goto LABEL_381;
                              }
                              if ( v300 == 1 )
                              {
                                v299 = 31;
                                v626 = -1297272415;
                                v298 = -1297272415;
                                break;
                              }
                              v626 = -894122362;
                              v298 = -894122362;
                              goto LABEL_425;
                            case 2u:
                              v301 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
                              if ( v301 )
                              {
                                if ( v301 == 1 )
                                {
                                  v592 = -665102064;
                                  v298 = -665102064;
                                  goto LABEL_419;
                                }
                                v299 = 2;
                                v592 = -2051698419;
                                v298 = -2051698419;
                              }
                              else
                              {
                                v299 = 12;
                                v592 = -700172780;
                                v298 = -700172778;
                              }
                              break;
                            case 3u:
                              v302 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
                              if ( v302 )
                              {
                                if ( v302 == 1 )
                                {
                                  v299 = 29;
                                  v645 = -1907430904;
                                  v298 = -1907430904;
                                }
                                else
                                {
                                  v299 = 3;
                                  v645 = -1816493533;
                                  v298 = -1816493533;
                                }
                              }
                              else
                              {
                                v299 = 15;
                                v645 = -1474152136;
                                v298 = -1474152133;
                              }
                              break;
                            case 4u:
                              v303 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
                              if ( v303 )
                              {
                                if ( v303 == 1 )
                                {
                                  v299 = 28;
                                  v593 = 1728537748;
                                  v298 = 1728537748;
                                }
                                else
                                {
                                  v299 = 4;
                                  v593 = 124032103;
                                  v298 = 124032103;
                                }
                              }
                              else
                              {
                                v299 = 18;
                                v593 = 622445021;
                                v298 = 622445017;
                              }
                              break;
                            case 5u:
                              v304 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
                              if ( v304 )
                              {
                                if ( v304 == 1 )
                                {
                                  v627 = 2068456210;
                                  v298 = 2068456210;
                                  goto LABEL_413;
                                }
                                v299 = 5;
                                v627 = 680282605;
                                v298 = 680282605;
                              }
                              else
                              {
                                v299 = 21;
                                v627 = 1240279177;
                                v298 = 1240279180;
                              }
                              break;
                            case 6u:
                              v305 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
                              if ( !v305 )
                              {
                                v594 = 1314342514;
                                v298 = 1314342516;
                                goto LABEL_407;
                              }
                              if ( v305 == 1 )
                              {
                                v299 = 26;
                                v594 = 962402769;
                                v298 = 962402769;
                              }
                              else
                              {
                                v594 = -778234987;
                                v298 = -778234987;
LABEL_374:
                                v299 = 6;
                              }
                              break;
                            case 7u:
                              v306 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
                              if ( v306 )
                              {
                                if ( v306 == 1 )
                                {
                                  v299 = 25;
                                  v635 = -2100910376;
                                  v298 = -2100910376;
                                }
                                else
                                {
                                  v299 = 7;
                                  v635 = -1447681871;
                                  v298 = -1447681871;
                                }
                              }
                              else
                              {
                                v635 = 186293093;
                                v298 = 186293090;
LABEL_413:
                                v299 = 27;
                              }
                              break;
                            case 8u:
                              v307 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
                              if ( v307 )
                              {
                                if ( v307 == 1 )
                                {
                                  v595 = 1094870118;
                                  v298 = 1094870118;
LABEL_407:
                                  v299 = 24;
                                }
                                else
                                {
                                  v299 = 8;
                                  v595 = 1684422978;
                                  v298 = 1684422978;
                                }
                              }
                              else
                              {
                                v595 = 1352210840;
                                v298 = 1352210832;
LABEL_419:
                                v299 = 30;
                              }
                              break;
                            case 9u:
                              v308 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
                              if ( v308 )
                              {
                                if ( v308 == 1 )
                                {
                                  v299 = 23;
                                  v628 = -1557388889;
                                  v298 = -1557388889;
                                }
                                else
                                {
                                  v628 = -2036429648;
                                  v298 = -2036429648;
LABEL_381:
                                  v299 = 9;
                                }
                              }
                              else
                              {
                                v628 = -1333354875;
                                v298 = -1333354868;
LABEL_425:
                                v299 = 1;
                              }
                              break;
                            case 0xAu:
                              v309 = __mrc(15, 0, 9, 13, 0);
                              v310 = v309 << 29;
                              v311 = v309 ^ (v309 >> 3);
                              v312 = 67117057i64 * (unsigned int)v311;
                              v313 = 1880096896 * v310
                                   + ((1880096896i64 * (unsigned int)v311 + 67117057 * (unsigned __int64)v310) >> 32);
                              if ( (0x7010008004002001i64 * __PAIR64__(v310, v311)) >> 32 < HIDWORD(v312) )
                                ++v313;
                              v314 = ((unsigned int)v312 ^ v313) >> 5;
                              v315 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v312 ^ (unsigned __int64)v313);
                              v316 = v314 >> 5;
                              v317 = FsRtlRemovePerStreamContextEx(26i64, v314);
                              v318 = FsRtlRemovePerStreamContextEx(26i64, v314 >> 5);
                              v297 = ((v315 + 97) << 24) | ((v318 + 97) << 8) | ((v317 + 65) << 16) | (FsRtlRemovePerStreamContextEx(26i64, v316 >> 5) + 65);
                              goto LABEL_429;
                          }
                          v297 = __ROR4__(v298, v299);
LABEL_429:
                          v319 = ExAllocatePoolWithTag(512, 4 * v563, v297);
                          if ( !v319 )
                            return 0;
                          if ( v566 )
                          {
                            v320 = (int *)v566;
                            v321 = (char *)v319;
                            v322 = 4 * v561;
                            if ( 4 * v561 >= 4 )
                            {
                              v323 = v322 >> 2;
                              do
                              {
                                v324 = *v320++;
                                v322 -= 4;
                                *(_DWORD *)v321 = v324;
                                v321 += 4;
                                --v323;
                              }
                              while ( v323 );
                            }
                            if ( v322 )
                            {
                              v325 = v321 - (char *)v320;
                              do
                              {
                                *((_BYTE *)v320 + v325) = *(_BYTE *)v320;
                                v320 = (int *)((char *)v320 + 1);
                                --v322;
                              }
                              while ( v322 );
                            }
                            ExFreePool(v566);
                          }
                          v285 = v319;
                          v270 = HIDWORD(v556);
                          v281 = v561;
                          v566 = v319;
                        }
                        v326 = (_DWORD *)(v285 + 4 * v281++);
                        v270 += 8;
                        HIDWORD(v556) = v270;
                        v561 = v281;
                        *v326 = v284;
                      }
                      v282 = v577;
                    }
                    while ( v279 );
                  }
                  v275 = v585 + 4096;
                  v585 = v275;
                }
                while ( v275 < v586 );
                v269 = (int *)HIDWORD(v656);
                v268 = v656;
                v267 = v654;
                v263 = v556;
                v265 = v568;
                v262 = v242 + 1104;
              }
              v264 = v572 + 1;
              v572 = v264;
            }
            while ( v264 < 8 );
            if ( v262 )
            {
              v327 = (_DWORD *)(v262 + 8 * (v263 + 1));
              v327[1] = 4;
              *v327 = &off_617994;
            }
            v328 = (unsigned int)&off_617994 & 0xFFFFF000;
            v578 = (unsigned int)&off_617994 & 0xFFFFF000;
            v558 = v270 + 4;
            do
            {
              v329 = (v328 >> 10) & 0x3FFFFC;
              v330 = 0;
              v331 = v648;
              v332 = 0;
              do
              {
                if ( v330 )
                {
                  v333 = (((unsigned int)(v329 - 1073741821) >> 10) & 0x3FFFFC) - 0x40000000;
                }
                else
                {
                  v333 = v329 - 0x40000000;
                  if ( (*(_DWORD *)((((unsigned int)(v329 - 0x40000000) >> 10) & 0x3FFFFC) - 0x40000000) & 0x400) != 0 )
                    v333 = 0;
                }
                if ( v333 )
                {
                  *v331++ = v333;
                  ++v332;
                }
                ++v330;
              }
              while ( v330 < 2 );
              v335 = v558;
              v334 = v561;
              if ( v332 )
              {
                v336 = &v648[v332];
                do
                {
                  v337 = v336 - 1;
                  v338 = *v337;
                  v339 = v566;
                  v340 = 0;
                  v587 = v337;
                  --v332;
                  if ( v334 )
                  {
                    v341 = (_DWORD *)v566;
                    do
                    {
                      if ( v338 == *v341 )
                        break;
                      ++v340;
                      ++v341;
                    }
                    while ( v340 < v334 );
                  }
                  if ( v340 == v334 )
                  {
                    if ( v334 == v563 )
                    {
                      v563 = 2 * (v563 + 32);
                      v342 = __mrc(15, 0, 9, 13, 0);
                      v343 = v342 << 29;
                      v344 = v342 ^ (v342 >> 3);
                      v345 = 67117057i64 * (unsigned int)v344;
                      v346 = 1880096896 * v344 + 67117057 * v343;
                      v349 = 1880096896 * v343
                           + ((1880096896i64 * (unsigned int)v344 + 67117057 * (unsigned __int64)v343) >> 32);
                      v348 = (1880096896i64 * v343
                            + ((1880096896i64 * (unsigned int)v344 + 67117057 * (unsigned __int64)v343) >> 32)) >> 32;
                      v347 = v349;
                      if ( (unsigned int)(v346 + HIDWORD(v345)) < HIDWORD(v345) )
                      {
                        v348 = (__PAIR64__(v348, v349) + 1) >> 32;
                        v347 = v349 + 1;
                      }
                      HIDWORD(v350) = v348 ^ (v346 + HIDWORD(v345));
                      LODWORD(v350) = v345 ^ v347;
                      switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v350) )
                      {
                        case 0u:
                          if ( !FsRtlRemovePerStreamContextEx(3i64, 0i64) )
                          {
                            v596 = -795291432;
                            v352 = -795291432;
                            goto LABEL_469;
                          }
                          v596 = 1665295171;
                          v351 = 1665295171;
                          goto LABEL_524;
                        case 1u:
                          v354 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
                          if ( !v354 )
                          {
                            v641 = -1262057781;
                            v352 = -1262057782;
                            goto LABEL_476;
                          }
                          if ( v354 == 1 )
                          {
                            v353 = 31;
                            v641 = -1297272415;
                            v352 = -1297272415;
                            break;
                          }
                          v641 = -894122362;
                          v352 = -894122362;
                          goto LABEL_520;
                        case 2u:
                          v355 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
                          if ( v355 )
                          {
                            if ( v355 == 1 )
                            {
                              v597 = -665102064;
                              v352 = -665102064;
                              goto LABEL_514;
                            }
                            v353 = 2;
                            v597 = -2051698419;
                            v352 = -2051698419;
                          }
                          else
                          {
                            v353 = 12;
                            v597 = -700172780;
                            v352 = -700172778;
                          }
                          break;
                        case 3u:
                          v356 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
                          if ( v356 )
                          {
                            if ( v356 == 1 )
                            {
                              v353 = 29;
                              v629 = -1907430904;
                              v352 = -1907430904;
                            }
                            else
                            {
                              v353 = 3;
                              v629 = -1816493533;
                              v352 = -1816493533;
                            }
                          }
                          else
                          {
                            v353 = 15;
                            v629 = -1474152136;
                            v352 = -1474152133;
                          }
                          break;
                        case 4u:
                          v357 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
                          if ( v357 )
                          {
                            if ( v357 == 1 )
                            {
                              v353 = 28;
                              v598 = 1728537748;
                              v352 = 1728537748;
                            }
                            else
                            {
                              v353 = 4;
                              v598 = 124032103;
                              v352 = 124032103;
                            }
                          }
                          else
                          {
                            v353 = 18;
                            v598 = 622445021;
                            v352 = 622445017;
                          }
                          break;
                        case 5u:
                          v358 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
                          if ( v358 )
                          {
                            if ( v358 == 1 )
                            {
                              v609 = 2068456210;
                              v352 = 2068456210;
                              goto LABEL_508;
                            }
                            v353 = 5;
                            v609 = 680282605;
                            v352 = 680282605;
                          }
                          else
                          {
                            v353 = 21;
                            v609 = 1240279177;
                            v352 = 1240279180;
                          }
                          break;
                        case 6u:
                          v359 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
                          if ( !v359 )
                          {
                            v599 = 1314342514;
                            v352 = 1314342516;
                            goto LABEL_502;
                          }
                          if ( v359 == 1 )
                          {
                            v353 = 26;
                            v599 = 962402769;
                            v352 = 962402769;
                          }
                          else
                          {
                            v599 = -778234987;
                            v352 = -778234987;
LABEL_469:
                            v353 = 6;
                          }
                          break;
                        case 7u:
                          v360 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
                          if ( v360 )
                          {
                            if ( v360 == 1 )
                            {
                              v353 = 25;
                              v610 = -2100910376;
                              v352 = -2100910376;
                            }
                            else
                            {
                              v353 = 7;
                              v610 = -1447681871;
                              v352 = -1447681871;
                            }
                          }
                          else
                          {
                            v610 = 186293093;
                            v352 = 186293090;
LABEL_508:
                            v353 = 27;
                          }
                          break;
                        case 8u:
                          v361 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
                          if ( v361 )
                          {
                            if ( v361 == 1 )
                            {
                              v600 = 1094870118;
                              v352 = 1094870118;
LABEL_502:
                              v353 = 24;
                            }
                            else
                            {
                              v353 = 8;
                              v600 = 1684422978;
                              v352 = 1684422978;
                            }
                          }
                          else
                          {
                            v600 = 1352210840;
                            v352 = 1352210832;
LABEL_514:
                            v353 = 30;
                          }
                          break;
                        case 9u:
                          v362 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
                          if ( v362 )
                          {
                            if ( v362 == 1 )
                            {
                              v353 = 23;
                              v612 = -1557388889;
                              v352 = -1557388889;
                            }
                            else
                            {
                              v612 = -2036429648;
                              v352 = -2036429648;
LABEL_476:
                              v353 = 9;
                            }
                          }
                          else
                          {
                            v612 = -1333354875;
                            v352 = -1333354868;
LABEL_520:
                            v353 = 1;
                          }
                          break;
                        case 0xAu:
                          v363 = __mrc(15, 0, 9, 13, 0);
                          v364 = v363 << 29;
                          v365 = v363 ^ (v363 >> 3);
                          v366 = 67117057i64 * (unsigned int)v365;
                          v367 = 1880096896 * v364
                               + ((1880096896i64 * (unsigned int)v365 + 67117057 * (unsigned __int64)v364) >> 32);
                          if ( (0x7010008004002001i64 * __PAIR64__(v364, v365)) >> 32 < HIDWORD(v366) )
                            ++v367;
                          v368 = ((unsigned int)v366 ^ v367) >> 5;
                          v369 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v366 ^ (unsigned __int64)v367);
                          v370 = v368 >> 5;
                          v371 = FsRtlRemovePerStreamContextEx(26i64, v368);
                          v372 = FsRtlRemovePerStreamContextEx(26i64, v368 >> 5);
                          v351 = ((v369 + 97) << 24) | ((v372 + 97) << 8) | ((v371 + 65) << 16) | (FsRtlRemovePerStreamContextEx(
                                                                                                     26i64,
                                                                                                     v370 >> 5)
                                                                                                 + 65);
                          goto LABEL_524;
                      }
                      v351 = __ROR4__(v352, v353);
LABEL_524:
                      v373 = ExAllocatePoolWithTag(512, 4 * v563, v351);
                      v374 = v373;
                      if ( !v373 )
                        return 0;
                      if ( v566 )
                      {
                        v375 = (int *)v566;
                        v376 = (char *)v373;
                        v377 = 4 * v561;
                        if ( 4 * v561 >= 4 )
                        {
                          v378 = v377 >> 2;
                          do
                          {
                            v379 = *v375++;
                            v377 -= 4;
                            *(_DWORD *)v376 = v379;
                            v376 += 4;
                            --v378;
                          }
                          while ( v378 );
                        }
                        if ( v377 )
                        {
                          v380 = v376 - (char *)v375;
                          do
                          {
                            *((_BYTE *)v375 + v380) = *(_BYTE *)v375;
                            v375 = (int *)((char *)v375 + 1);
                            --v377;
                          }
                          while ( v377 );
                        }
                        ExFreePool(v566);
                      }
                      v339 = v374;
                      v335 = v558;
                      v334 = v561;
                      v566 = v374;
                    }
                    v381 = (_DWORD *)(v339 + 4 * v334++);
                    v335 += 8;
                    v558 = v335;
                    v561 = v334;
                    *v381 = v338;
                  }
                  v336 = v587;
                }
                while ( v332 );
              }
              v328 = v578 + 4096;
              v578 = v328;
            }
            while ( v328 < (unsigned int)algn_617998 );
            if ( v242 != -1104 )
            {
              v382 = v242 + 1112;
              *(_DWORD *)(v242 + 1108) = v334;
              v383 = (char *)(v242 + 1112 + 8 * (v556 + 1));
              if ( v334 )
              {
                v384 = (_DWORD **)v566;
                do
                {
                  v385 = *v384++;
                  *(_DWORD *)v383 = v385;
                  *((_DWORD *)v383 + 1) = *v385;
                  v383 += 8;
                  --v334;
                }
                while ( v334 );
              }
              while ( v382 < v242 + 1112 + 8 * ((int)v556 + 1) )
              {
                v386 = *(_DWORD *)(v382 + 4);
                v387 = *(int **)v382;
                v388 = v383;
                if ( v386 >= 4 )
                {
                  v389 = v386 >> 2;
                  do
                  {
                    v390 = *v387++;
                    v386 -= 4;
                    *(_DWORD *)v388 = v390;
                    v388 += 4;
                    --v389;
                  }
                  while ( v389 );
                }
                if ( v386 )
                {
                  v391 = v388 - (char *)v387;
                  do
                  {
                    *((_BYTE *)v387 + v391) = *(_BYTE *)v387;
                    v387 = (int *)((char *)v387 + 1);
                    --v386;
                  }
                  while ( v386 );
                }
                v383 += *(_DWORD *)(v382 + 4);
                v382 += 8;
              }
              *(_DWORD *)(v242 + 1104) = v556 + 1;
            }
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            v392 = v581;
            __enable_irq();
            v393 = v19 + v392;
            *(_DWORD *)(v584 + 796) = v19 + v392;
            *(_DWORD *)(v584 + 780) = v576;
            memmove(v584, (unsigned int)ExpWnfAcquireNameInstanceShared & 0xFFFFFFFE, 0xC4u);
            *(_DWORD *)(v584 + 808) = v574 + v392;
            *(_DWORD *)(v584 + 800) = v573 + v392;
            *(_DWORD *)(v584 + 804) = v567 + v392;
            *(_DWORD *)(v584 + 812) = v565 + v392;
            *(_DWORD *)(v584 + 816) = v564 + v392;
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            *(_DWORD *)(v584 + 208) = ExAcquireResourceSharedLite;
            *(_DWORD *)(v584 + 212) = ExAcquireResourceExclusiveLite;
            *(_DWORD *)(v584 + 216) = ExAllocatePoolWithTag;
            *(_DWORD *)(v584 + 220) = ExFreePool;
            *(_DWORD *)(v584 + 224) = ExMapHandleToPointer;
            *(_DWORD *)(v584 + 228) = ExQueueWorkItem;
            *(_DWORD *)(v584 + 232) = ExReleaseResourceLite;
            *(_DWORD *)(v584 + 236) = ExUnlockHandleTableEntry;
            *(_DWORD *)(v584 + 240) = ExAcquirePushLockExclusiveEx;
            *(_DWORD *)(v584 + 244) = ExReleasePushLockExclusiveEx;
            *(_DWORD *)(v584 + 248) = ExAcquirePushLockSharedEx;
            *(_DWORD *)(v584 + 252) = ExReleasePushLockSharedEx;
            *(_DWORD *)(v584 + 256) = KeAcquireInStackQueuedSpinLockAtDpcLevel;
            *(_DWORD *)(v584 + 260) = ExAcquireSpinLockSharedAtDpcLevel;
            *(_DWORD *)(v584 + 264) = KeBugCheckEx;
            *(_DWORD *)(v584 + 268) = KeDelayExecutionThread;
            *(_DWORD *)(v584 + 272) = KeEnterCriticalRegionThread;
            *(_DWORD *)(v584 + 276) = KeLeaveCriticalRegion;
            *(_DWORD *)(v584 + 280) = KeEnterGuardedRegion;
            *(_DWORD *)(v584 + 284) = KeLeaveGuardedRegion;
            *(_DWORD *)(v584 + 288) = KeReleaseInStackQueuedSpinLockFromDpcLevel;
            *(_DWORD *)(v584 + 292) = ExReleaseSpinLockSharedFromDpcLevel;
            *(_DWORD *)(v584 + 296) = KeRevertToUserAffinityThread;
            *(_DWORD *)(v584 + 304) = KeSetSystemGroupAffinityThread;
            *(_DWORD *)(v584 + 300) = KeProcessorGroupAffinity;
            *(_DWORD *)(v584 + 308) = KeSetCoalescableTimer;
            *(_DWORD *)(v584 + 324) = RtlImageNtHeader;
            *(_DWORD *)(v584 + 336) = RtlSectionTableFromVirtualAddress;
            *(_DWORD *)(v584 + 328) = RtlLookupFunctionTable;
            *(_DWORD *)(v584 + 332) = RtlPcToFileHeader;
            *(_DWORD *)(v584 + 312) = ObfDereferenceObject;
            *(_DWORD *)(v584 + 316) = ObReferenceObjectByName;
            *(_DWORD *)(v584 + 320) = RtlImageDirectoryEntryToData;
            *(_DWORD *)(v584 + 340) = DbgPrint;
            *(_DWORD *)(v584 + 344) = MmAllocateIndependentPages;
            *(_DWORD *)(v584 + 348) = MmFreeIndependentPages;
            *(_DWORD *)(v584 + 352) = MmSetPageProtection;
            *(_DWORD *)(v584 + 356) = KfRaiseIrql;
            *(_DWORD *)(v584 + 360) = KfLowerIrql;
            *(_DWORD *)(v584 + 364) = KeGetCurrentIrql;
            *(_DWORD *)(v584 + 368) = KeSweepIcache;
            *(_DWORD *)(v584 + 372) = RtlLookupFunctionEntry;
            *(_DWORD *)(v584 + 376) = KeAcquireSpinLockRaiseToDpc;
            *(_DWORD *)(v584 + 380) = KeReleaseSpinLock;
            *(_DWORD *)(v584 + 384) = MmGetSessionById;
            *(_DWORD *)(v584 + 388) = MmGetNextSession;
            *(_DWORD *)(v584 + 392) = MmQuitNextSession;
            *(_DWORD *)(v584 + 396) = MmAttachSession;
            *(_DWORD *)(v584 + 400) = MmDetachSession;
            *(_DWORD *)(v584 + 404) = MmGetSessionIdEx;
            *(_DWORD *)(v584 + 408) = MmIsSessionAddress;
            *(_DWORD *)(v584 + 412) = KeInsertQueueApc;
            *(_DWORD *)(v584 + 416) = KeWaitForSingleObject;
            *(_DWORD *)(v584 + 424) = ExReferenceCallBackBlock;
            *(_DWORD *)(v584 + 428) = KeReadStateSemaphore;
            *(_DWORD *)(v584 + 432) = ExDereferenceCallBackBlock;
            *(_DWORD *)(v584 + 436) = sub_5011C4;
            *(_DWORD *)(v584 + 440) = PspEnumerateCallback;
            *(_DWORD *)(v584 + 444) = CmpEnumerateCallback;
            *(_DWORD *)(v584 + 448) = DbgEnumerateCallback;
            *(_DWORD *)(v584 + 452) = ExpEnumerateCallback;
            *(_DWORD *)(v584 + 456) = ExpGetNextCallback;
            *(_DWORD *)(v584 + 460) = PopPoCoalescinCallback;
            *(_DWORD *)(v584 + 464) = KiSchedulerApcTerminate;
            *(_DWORD *)(v584 + 468) = KiSchedulerApc;
            *(_DWORD *)(v584 + 472) = PopPoCoalescinCallback;
            *(_DWORD *)(v584 + 476) = sub_500E50;
            *(_DWORD *)(v584 + 480) = MmAllocatePagesForMdlEx;
            *(_DWORD *)(v584 + 484) = MmAllocateMappingAddress;
            *(_DWORD *)(v584 + 488) = MmMapLockedPagesWithReservedMapping;
            *(_DWORD *)(v584 + 492) = MmUnmapReservedMapping;
            *(_DWORD *)(v584 + 496) = sub_50103C;
            *(_DWORD *)(v584 + 500) = sub_501078;
            *(_DWORD *)(v584 + 504) = MmAcquireLoadLock;
            *(_DWORD *)(v584 + 508) = MmReleaseLoadLock;
            *(_DWORD *)(v584 + 512) = KeEnumerateQueueApc;
            *(_DWORD *)(v584 + 516) = KeIsApcRunningThread;
            *(_DWORD *)(v584 + 520) = __104;
            *(_DWORD *)(v584 + 524) = PsAcquireProcessExitSynchronization;
            *(_DWORD *)(v584 + 528) = PsReleaseProcessExitSynchronization;
            *(_DWORD *)(v584 + 532) = PsGetNextProcess;
            *(_DWORD *)(v584 + 536) = MmIsSessionLeaderProcess;
            *(_DWORD *)(v584 + 540) = PsInvokeWin32Callout;
            *(_DWORD *)(v584 + 544) = MmEnumerateAddressSpaceAndReferenceImages;
            *(_DWORD *)(v584 + 548) = PsGetProcessProtection;
            *(_DWORD *)(v584 + 552) = PsGetProcessSignatureLevel;
            *(_DWORD *)(v584 + 556) = PsGetProcessSectionBaseAddress;
            *(_DWORD *)(v584 + 560) = SeCompareSigningLevels;
            *(_DWORD *)(v584 + 584) = RtlIsMultiSessionSku;
            *(_DWORD *)(v584 + 572) = KeSetEvent;
            if ( v640 )
              *(_DWORD *)(v584 + 420) = *(_DWORD *)(v640 + 20);
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            v394 = v588;
            __enable_irq();
            *(_DWORD *)(v584 + 928) = v394;
            *(_DWORD *)(v584 + 956) = v393;
            *(_DWORD *)(v584 + 960) = &qword_618DC0;
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            v395 = __mrc(15, 0, 9, 13, 0);
            v396 = v395 << 29;
            v397 = v395 ^ (v395 >> 3);
            v398 = 67117057i64 * (unsigned int)v397;
            v399 = 1880096896 * v397 + 67117057 * v396;
            v402 = 1880096896 * v396 + ((1880096896i64 * (unsigned int)v397 + 67117057 * (unsigned __int64)v396) >> 32);
            v401 = (1880096896i64 * v396
                  + ((1880096896i64 * (unsigned int)v397 + 67117057 * (unsigned __int64)v396) >> 32)) >> 32;
            v400 = v402;
            if ( (unsigned int)(v399 + HIDWORD(v398)) < HIDWORD(v398) )
            {
              v401 = (__PAIR64__(v401, v402) + 1) >> 32;
              v400 = v402 + 1;
            }
            HIDWORD(v403) = v401 ^ (v399 + HIDWORD(v398));
            LODWORD(v403) = v398 ^ v400;
            _rt_udiv64(10i64, v403);
            if ( v404 >= 3 )
            {
              *(_DWORD *)(v584 + 932) = 0;
            }
            else
            {
              *(_DWORD *)(v584 + 932) = 4;
              v405 = __mrc(15, 0, 9, 13, 0);
              v406 = v405 << 29;
              v407 = v405 ^ (v405 >> 3);
              v408 = 67117057i64 * (unsigned int)v407;
              v409 = 1880096896 * v407 + 67117057 * v406;
              v412 = 1880096896 * v406
                   + ((1880096896i64 * (unsigned int)v407 + 67117057 * (unsigned __int64)v406) >> 32);
              v411 = (1880096896i64 * v406
                    + ((1880096896i64 * (unsigned int)v407 + 67117057 * (unsigned __int64)v406) >> 32)) >> 32;
              v410 = v412;
              if ( (unsigned int)(v409 + HIDWORD(v408)) < HIDWORD(v408) )
              {
                v411 = (__PAIR64__(v411, v412) + 1) >> 32;
                v410 = v412 + 1;
              }
              HIDWORD(v413) = v411 ^ (v409 + HIDWORD(v408));
              LODWORD(v413) = v408 ^ v410;
              _rt_udiv64(7i64, v413);
              *(_DWORD *)(v584 + 932) = v414;
            }
            v415 = dword_982140;
            if ( (unsigned int)dword_982140 > 0x1F )
            {
              v416 = FsRtlRemovePerStreamContextEx(3i64, 0x26C1ui64);
              if ( v416 )
              {
                if ( v416 == 1 )
                {
                  v417 = -2147483490;
                  v418 = 31;
                }
                else
                {
                  v417 = 634;
                  v418 = 1;
                }
                v601 = v417;
                v419 = __ROR4__(v417, v418);
              }
              else
              {
                v601 = 154817;
                v419 = __ROR4__(162304, 9);
              }
              KeBugCheckEx(v419, 3, 0, v415, 0);
            }
            *(_DWORD *)(v584 + 992) ^= ((unsigned __int16)*(_DWORD *)(v584 + 992) ^ (unsigned __int16)((_WORD)dword_982140 << 10)) & 0x7C00;
            *(_DWORD *)(v584 + 820) = 0;
            *(char **)(v584 + 936) = VfExcludeSections[0];
            *(char **)(v584 + 940) = off_61887C[0];
            *(char **)(v584 + 944) = off_618880[0];
            *(_DWORD *)(v584 + 948) = off_618884;
            v420 = __mrc(15, 0, 9, 13, 0);
            v421 = v420 << 29;
            v422 = v420 ^ (v420 >> 3);
            v423 = 67117057i64 * (unsigned int)v422;
            v424 = 1880096896 * v422 + 67117057 * v421;
            v427 = 1880096896 * v421 + ((1880096896i64 * (unsigned int)v422 + 67117057 * (unsigned __int64)v421) >> 32);
            v426 = (1880096896i64 * v421
                  + ((1880096896i64 * (unsigned int)v422 + 67117057 * (unsigned __int64)v421) >> 32)) >> 32;
            v425 = v427;
            if ( (unsigned int)(v424 + HIDWORD(v423)) < HIDWORD(v423) )
            {
              v426 = (__PAIR64__(v426, v427) + 1) >> 32;
              v425 = v427 + 1;
            }
            HIDWORD(v428) = v426 ^ (v424 + HIDWORD(v423));
            LODWORD(v428) = v423 ^ v425;
            _rt_udiv64(1000i64, v428);
            if ( v429 < 3 )
              *(_DWORD *)(v584 + 996) |= 8u;
            *(_DWORD *)(v584 + 776) = KeGetPrcb(0);
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            v430 = v625;
            __enable_irq();
            *(_DWORD *)(v584 + 860) = FsRtlReInitializeTunnelCache(v430, 0x140000ui64);
            *(_DWORD *)(v584 + 600) = PsInitialSystemProcess;
            *(_DWORD *)(v584 + 608) = KiWaitAlways;
            *(_DWORD *)(v584 + 612) = dword_681F7C;
            *(_DWORD *)(v584 + 616) = &KiEntropyTimingRoutine;
            *(_DWORD *)(v584 + 620) = &KiProcessListHead;
            *(_DWORD *)(v584 + 624) = KiProcessListLock;
            *(_DWORD *)(v584 + 628) = ObpTypeObjectType;
            *(_DWORD *)(v584 + 632) = IoDriverObjectType;
            *(_DWORD *)(v584 + 636) = &PsActiveProcessHead;
            *(_DWORD *)(v584 + 640) = PsInvertedFunctionTable;
            *(_DWORD *)(v584 + 644) = &PsLoadedModuleList;
            *(_DWORD *)(v584 + 648) = &PsLoadedModuleResource;
            *(_DWORD *)(v584 + 652) = &PsLoadedModuleSpinLock;
            *(_DWORD *)(v584 + 656) = &PspActiveProcessLock;
            *(_DWORD *)(v584 + 660) = &PspCidTable;
            *(_DWORD *)(v584 + 664) = &ExpUuidLock;
            *(_DWORD *)(v584 + 668) = &AlpcpPortListLock;
            *(_DWORD *)(v584 + 672) = &KeServiceDescriptorTable;
            *(_DWORD *)(v584 + 676) = &KeServiceDescriptorTableShadow;
            *(_DWORD *)(v584 + 680) = &VfThunksExtended;
            *(_DWORD *)(v584 + 684) = &PsWin32CallBack;
            *(_DWORD *)(v584 + 688) = &dword_618DA8;
            *(_DWORD *)(v584 + 692) = &KiTableInformation;
            *(_DWORD *)(v584 + 696) = &HandleTableListHead;
            *(_DWORD *)(v584 + 700) = &HandleTableListLock;
            *(_DWORD *)(v584 + 704) = ObpKernelHandleTable;
            *(_DWORD *)(v584 + 708) = -28672;
            *(_DWORD *)(v584 + 712) = KiWaitNever;
            *(_DWORD *)(v584 + 716) = dword_681F6C;
            *(_DWORD *)(v584 + 720) = SeProtectedMapping;
            *(_DWORD *)(v584 + 728) = &CcPeriodicEvent;
            __disable_irq();
            if ( !KdDebuggerNotPresent )
            {
              while ( 1 )
                ;
            }
            __enable_irq();
            *(_DWORD *)(v584 + 824) = v393;
            v431 = __mrc(15, 0, 9, 13, 0);
            v432 = v431 << 29;
            v433 = v431 ^ (v431 >> 3);
            v434 = 67117057i64 * (unsigned int)v433;
            v435 = 67117057 * v432 + 1880096896 * v433;
            v438 = 1880096896 * v432 + ((67117057i64 * v432 + 1880096896 * (unsigned __int64)(unsigned int)v433) >> 32);
            v437 = (1880096896i64 * v432
                  + ((67117057i64 * v432 + 1880096896 * (unsigned __int64)(unsigned int)v433) >> 32)) >> 32;
            v436 = v438;
            if ( (unsigned int)(v435 + HIDWORD(v434)) < HIDWORD(v434) )
            {
              v437 = (__PAIR64__(v437, v438) + 1) >> 32;
              v436 = v438 + 1;
            }
            HIDWORD(v439) = v437 ^ (v435 + HIDWORD(v434));
            LODWORD(v439) = v434 ^ v436;
            switch ( (unsigned int)FsRtlRemovePerStreamContextEx(11i64, v439) )
            {
              case 0u:
                if ( FsRtlRemovePerStreamContextEx(3i64, 0i64) )
                {
                  v614 = 1665295171;
                  v440 = 1665295171;
                  goto LABEL_645;
                }
                v614 = -795291432;
                v441 = -795291432;
                goto LABEL_590;
              case 1u:
                v443 = FsRtlRemovePerStreamContextEx(3i64, 1ui64);
                if ( v443 )
                {
                  if ( v443 == 1 )
                  {
                    v442 = 31;
                    v602 = -1297272415;
                    v441 = -1297272415;
LABEL_591:
                    v440 = __ROR4__(v441, v442);
LABEL_645:
                    *(_DWORD *)(v584 + 832) = v440;
                    v462 = __mrc(15, 0, 9, 13, 0);
                    v463 = v462 << 29;
                    v464 = v462 ^ (v462 >> 3);
                    v465 = 67117057i64 * (unsigned int)v464;
                    v466 = 1880096896 * v464 + 67117057 * v463;
                    v469 = 1880096896 * v463
                         + ((1880096896i64 * (unsigned int)v464 + 67117057 * (unsigned __int64)v463) >> 32);
                    v468 = (1880096896i64 * v463
                          + ((1880096896i64 * (unsigned int)v464 + 67117057 * (unsigned __int64)v463) >> 32)) >> 32;
                    v467 = v469;
                    if ( (unsigned int)(v466 + HIDWORD(v465)) < HIDWORD(v465) )
                    {
                      v468 = (__PAIR64__(v468, v469) + 1) >> 32;
                      v467 = v469 + 1;
                    }
                    HIDWORD(v470) = v468 ^ (v466 + HIDWORD(v465));
                    LODWORD(v470) = v465 ^ v467;
                    _rt_udiv64(63i64, v470);
                    *(_DWORD *)(v584 + 836) = v471 + 1;
                    v472 = __mrc(15, 0, 9, 13, 0);
                    v473 = v472 << 29;
                    v474 = v472 ^ (v472 >> 3);
                    v475 = 67117057i64 * (unsigned int)v474;
                    v476 = 1880096896i64 * (unsigned int)v474 + 67117057i64 * v473;
                    v477 = (1880096896i64 * v473 + (unsigned __int64)HIDWORD(v476)) >> 32;
                    v478 = 1880096896 * v473 + HIDWORD(v476);
                    if ( (unsigned int)(v476 + HIDWORD(v475)) < HIDWORD(v475) )
                      v477 = (__PAIR64__(v477, v478++) + 1) >> 32;
                    *(_DWORD *)(v584 + 840) = v478 ^ v475;
                    *(_DWORD *)(v584 + 844) = v477 ^ (v476 + HIDWORD(v475));
                    if ( *(int *)(v584 + 840) >= 0 )
                      v479 = 700 - v393;
                    else
                      v479 = 724 - v393;
                    *(_DWORD *)(v584 + 956) = (*(_DWORD *)(v584 + 956) + v479) ^ 0xBC2A27DB;
                    v480 = __mrc(15, 0, 9, 13, 0);
                    v481 = v480 << 29;
                    v482 = v480 ^ (v480 >> 3);
                    v483 = 67117057i64 * (unsigned int)v482;
                    v484 = 1880096896 * v482 + 67117057 * v481;
                    v487 = 1880096896 * v481
                         + ((1880096896i64 * (unsigned int)v482 + 67117057 * (unsigned __int64)v481) >> 32);
                    v486 = (1880096896i64 * v481
                          + ((1880096896i64 * (unsigned int)v482 + 67117057 * (unsigned __int64)v481) >> 32)) >> 32;
                    v485 = v487;
                    if ( (unsigned int)(v484 + HIDWORD(v483)) < HIDWORD(v483) )
                    {
                      v486 = (__PAIR64__(v486, v487) + 1) >> 32;
                      v485 = v487 + 1;
                    }
                    HIDWORD(v488) = v486 ^ (v484 + HIDWORD(v483));
                    LODWORD(v488) = v483 ^ v485;
                    _rt_udiv64(10i64, v488);
                    if ( v489 < 3 )
                      *(_DWORD *)(v584 + 992) |= 8u;
                    v490 = __mrc(15, 0, 9, 13, 0);
                    v491 = v490 << 29;
                    v492 = v490 ^ (v490 >> 3);
                    v493 = 67117057i64 * (unsigned int)v492;
                    v494 = 1880096896 * v492 + 67117057 * v491;
                    v497 = 1880096896 * v491
                         + ((1880096896i64 * (unsigned int)v492 + 67117057 * (unsigned __int64)v491) >> 32);
                    v496 = (1880096896i64 * v491
                          + ((1880096896i64 * (unsigned int)v492 + 67117057 * (unsigned __int64)v491) >> 32)) >> 32;
                    v495 = v497;
                    if ( (unsigned int)(v494 + HIDWORD(v493)) < HIDWORD(v493) )
                    {
                      v496 = (__PAIR64__(v496, v497) + 1) >> 32;
                      v495 = v497 + 1;
                    }
                    HIDWORD(v498) = v496 ^ (v494 + HIDWORD(v493));
                    LODWORD(v498) = v493 ^ v495;
                    _rt_udiv64(10i64, v498);
                    if ( v499 < 3 )
                      *(_DWORD *)(v584 + 992) |= 0x4000000u;
                    v500 = __mrc(15, 0, 9, 13, 0);
                    v501 = v500 << 29;
                    v502 = v500 ^ (v500 >> 3);
                    v503 = 67117057i64 * (unsigned int)v502;
                    v504 = 1880096896 * v502 + 67117057 * v501;
                    v507 = 1880096896 * v501
                         + ((1880096896i64 * (unsigned int)v502 + 67117057 * (unsigned __int64)v501) >> 32);
                    v506 = (1880096896i64 * v501
                          + ((1880096896i64 * (unsigned int)v502 + 67117057 * (unsigned __int64)v501) >> 32)) >> 32;
                    v505 = v507;
                    if ( (unsigned int)(v504 + HIDWORD(v503)) < HIDWORD(v503) )
                    {
                      v506 = (__PAIR64__(v506, v507) + 1) >> 32;
                      v505 = v507 + 1;
                    }
                    HIDWORD(v508) = v506 ^ (v504 + HIDWORD(v503));
                    LODWORD(v508) = v503 ^ v505;
                    _rt_udiv64(10i64, v508);
                    if ( !v510 && !v509 )
                      *(_DWORD *)(v584 + 992) |= 0x8000u;
                    v511 = __mrc(15, 0, 9, 13, 0);
                    v512 = v511 << 29;
                    v513 = v511 ^ (v511 >> 3);
                    v514 = 67117057i64 * (unsigned int)v513;
                    v515 = 1880096896 * v513 + 67117057 * v512;
                    v518 = 1880096896 * v512
                         + ((1880096896i64 * (unsigned int)v513 + 67117057 * (unsigned __int64)v512) >> 32);
                    v517 = (1880096896i64 * v512
                          + ((1880096896i64 * (unsigned int)v513 + 67117057 * (unsigned __int64)v512) >> 32)) >> 32;
                    v516 = v518;
                    if ( (unsigned int)(v515 + HIDWORD(v514)) < HIDWORD(v514) )
                    {
                      v517 = (__PAIR64__(v517, v518) + 1) >> 32;
                      v516 = v518 + 1;
                    }
                    HIDWORD(v519) = v517 ^ (v515 + HIDWORD(v514));
                    LODWORD(v519) = v514 ^ v516;
                    _rt_udiv64(10i64, v519);
                    if ( v520 < 3 )
                      *(_DWORD *)(v584 + 992) |= 0x400000u;
                    __disable_irq();
                    if ( !KdDebuggerNotPresent )
                    {
                      while ( 1 )
                        ;
                    }
                    __enable_irq();
                    v521 = __mrc(15, 0, 9, 13, 0);
                    v522 = v521 << 29;
                    v523 = v521 ^ (v521 >> 3);
                    v524 = 67117057i64 * (unsigned int)v523;
                    v525 = 67117057 * v522 + 1880096896 * v523;
                    v528 = 1880096896 * v522
                         + ((67117057i64 * v522 + 1880096896 * (unsigned __int64)(unsigned int)v523) >> 32);
                    v527 = (1880096896i64 * v522
                          + ((67117057i64 * v522 + 1880096896 * (unsigned __int64)(unsigned int)v523) >> 32)) >> 32;
                    v526 = v528;
                    if ( (unsigned int)(v525 + HIDWORD(v524)) < HIDWORD(v524) )
                    {
                      v527 = (__PAIR64__(v527, v528) + 1) >> 32;
                      v526 = v528 + 1;
                    }
                    HIDWORD(v529) = v527 ^ (v525 + HIDWORD(v524));
                    LODWORD(v529) = v524 ^ v526;
                    _rt_udiv64(10i64, v529);
                    if ( !v531 && !v530 )
                      *(_DWORD *)(v584 + 992) |= 0x8000000u;
                    v532 = __mrc(15, 0, 9, 13, 0);
                    v533 = v532 << 29;
                    v534 = v532 ^ (v532 >> 3);
                    v535 = 67117057i64 * (unsigned int)v534;
                    v536 = 67117057 * v533 + 1880096896 * v534;
                    v539 = 1880096896 * v533
                         + ((67117057i64 * v533 + 1880096896 * (unsigned __int64)(unsigned int)v534) >> 32);
                    v538 = (1880096896i64 * v533
                          + ((67117057i64 * v533 + 1880096896 * (unsigned __int64)(unsigned int)v534) >> 32)) >> 32;
                    v537 = v539;
                    if ( (unsigned int)(v536 + HIDWORD(v535)) < HIDWORD(v535) )
                    {
                      v538 = (__PAIR64__(v538, v539) + 1) >> 32;
                      v537 = v539 + 1;
                    }
                    HIDWORD(v540) = v538 ^ (v536 + HIDWORD(v535));
                    LODWORD(v540) = v535 ^ v537;
                    v541 = _rt_udiv64(10i64, v540);
                    if ( v542 < 3 )
                      *(_DWORD *)(v584 + 996) |= 4u;
                    v543 = v590;
                    if ( v640 && (v607 & 1) != 0 && v590 != 4 )
                    {
                      v544 = __mrc(15, 0, 9, 13, 0);
                      v545 = v544 << 29;
                      v546 = v544 ^ (v544 >> 3);
                      v547 = 67117057i64 * (unsigned int)v546;
                      v548 = 67117057 * v545 + 1880096896 * v546;
                      v551 = 1880096896 * v545
                           + ((67117057i64 * v545 + 1880096896 * (unsigned __int64)(unsigned int)v546) >> 32);
                      v550 = (1880096896i64 * v545
                            + ((67117057i64 * v545 + 1880096896 * (unsigned __int64)(unsigned int)v546) >> 32)) >> 32;
                      v549 = v551;
                      if ( (unsigned int)(v548 + HIDWORD(v547)) < HIDWORD(v547) )
                      {
                        v550 = (__PAIR64__(v550, v551) + 1) >> 32;
                        v549 = v551 + 1;
                      }
                      HIDWORD(v552) = v550 ^ (v548 + HIDWORD(v547));
                      LODWORD(v552) = v547 ^ v549;
                      v541 = _rt_udiv64(10i64, v552);
                      v543 = v590;
                      if ( v553 < 6 )
                        *(_DWORD *)(v584 + 996) |= 1u;
                    }
                    if ( (*(int (__fastcall **)(int))(v584 + 584))(v541) )
                      *(_DWORD *)(v584 + 996) |= 2u;
                    *(_DWORD *)(v584 + 872) = v543;
                    __disable_irq();
                    if ( !KdDebuggerNotPresent )
                    {
                      while ( 1 )
                        ;
                    }
                    __enable_irq();
                    *(_BYTE *)(v584 + 920) = 32;
                    sub_947E74(v584);
                  }
                  v602 = -894122362;
                  v441 = -894122362;
LABEL_641:
                  v442 = 1;
                  goto LABEL_591;
                }
                v602 = -1262057781;
                v441 = -1262057782;
                break;
              case 2u:
                v444 = FsRtlRemovePerStreamContextEx(3i64, 2ui64);
                if ( !v444 )
                {
                  v442 = 12;
                  v616 = -700172780;
                  v441 = -700172778;
                  goto LABEL_591;
                }
                if ( v444 != 1 )
                {
                  v442 = 2;
                  v616 = -2051698419;
                  v441 = -2051698419;
                  goto LABEL_591;
                }
                v616 = -665102064;
                v441 = -665102064;
                goto LABEL_635;
              case 3u:
                v445 = FsRtlRemovePerStreamContextEx(3i64, 3ui64);
                if ( v445 )
                {
                  if ( v445 == 1 )
                  {
                    v442 = 29;
                    v603 = -1907430904;
                    v441 = -1907430904;
                  }
                  else
                  {
                    v442 = 3;
                    v603 = -1816493533;
                    v441 = -1816493533;
                  }
                }
                else
                {
                  v442 = 15;
                  v603 = -1474152136;
                  v441 = -1474152133;
                }
                goto LABEL_591;
              case 4u:
                v446 = FsRtlRemovePerStreamContextEx(3i64, 4ui64);
                if ( v446 )
                {
                  if ( v446 == 1 )
                  {
                    v442 = 28;
                    v618 = 1728537748;
                    v441 = 1728537748;
                  }
                  else
                  {
                    v442 = 4;
                    v618 = 124032103;
                    v441 = 124032103;
                  }
                }
                else
                {
                  v442 = 18;
                  v618 = 622445021;
                  v441 = 622445017;
                }
                goto LABEL_591;
              case 5u:
                v447 = FsRtlRemovePerStreamContextEx(3i64, 5ui64);
                if ( v447 )
                {
                  if ( v447 == 1 )
                  {
                    v604 = 2068456210;
                    v441 = 2068456210;
LABEL_629:
                    v442 = 27;
                  }
                  else
                  {
                    v442 = 5;
                    v604 = 680282605;
                    v441 = 680282605;
                  }
                }
                else
                {
                  v442 = 21;
                  v604 = 1240279177;
                  v441 = 1240279180;
                }
                goto LABEL_591;
              case 6u:
                v448 = FsRtlRemovePerStreamContextEx(3i64, 6ui64);
                if ( !v448 )
                {
                  v620 = 1314342514;
                  v441 = 1314342516;
LABEL_623:
                  v442 = 24;
                  goto LABEL_591;
                }
                if ( v448 == 1 )
                {
                  v442 = 26;
                  v620 = 962402769;
                  v441 = 962402769;
                }
                else
                {
                  v620 = -778234987;
                  v441 = -778234987;
LABEL_590:
                  v442 = 6;
                }
                goto LABEL_591;
              case 7u:
                v449 = FsRtlRemovePerStreamContextEx(3i64, 7ui64);
                if ( v449 )
                {
                  if ( v449 == 1 )
                  {
                    v442 = 25;
                    v605 = -2100910376;
                    v441 = -2100910376;
                  }
                  else
                  {
                    v442 = 7;
                    v605 = -1447681871;
                    v441 = -1447681871;
                  }
                  goto LABEL_591;
                }
                v605 = 186293093;
                v441 = 186293090;
                goto LABEL_629;
              case 8u:
                v450 = FsRtlRemovePerStreamContextEx(3i64, 8ui64);
                if ( !v450 )
                {
                  v622 = 1352210840;
                  v441 = 1352210832;
LABEL_635:
                  v442 = 30;
                  goto LABEL_591;
                }
                if ( v450 != 1 )
                {
                  v442 = 8;
                  v622 = 1684422978;
                  v441 = 1684422978;
                  goto LABEL_591;
                }
                v622 = 1094870118;
                v441 = 1094870118;
                goto LABEL_623;
              case 9u:
                v451 = FsRtlRemovePerStreamContextEx(3i64, 9ui64);
                if ( !v451 )
                {
                  v606 = -1333354875;
                  v441 = -1333354868;
                  goto LABEL_641;
                }
                if ( v451 == 1 )
                {
                  v442 = 23;
                  v606 = -1557388889;
                  v441 = -1557388889;
                  goto LABEL_591;
                }
                v606 = -2036429648;
                v441 = -2036429648;
                break;
              case 0xAu:
                v452 = __mrc(15, 0, 9, 13, 0);
                v453 = v452 << 29;
                v454 = v452 ^ (v452 >> 3);
                v455 = 67117057i64 * (unsigned int)v454;
                v456 = 1880096896 * v453
                     + ((1880096896i64 * (unsigned int)v454 + 67117057 * (unsigned __int64)v453) >> 32);
                if ( (0x7010008004002001i64 * __PAIR64__(v453, v454)) >> 32 < HIDWORD(v455) )
                  ++v456;
                v457 = ((unsigned int)v455 ^ v456) >> 5;
                v458 = FsRtlRemovePerStreamContextEx(26i64, (unsigned int)v455 ^ (unsigned __int64)v456);
                v459 = v457 >> 5;
                v460 = FsRtlRemovePerStreamContextEx(26i64, v457);
                v461 = FsRtlRemovePerStreamContextEx(26i64, v457 >> 5);
                v440 = (FsRtlRemovePerStreamContextEx(26i64, v459 >> 5) + 65) | ((v458 + 97) << 24) | ((v461 + 97) << 8) | ((v460 + 65) << 16);
                goto LABEL_645;
            }
            v442 = 9;
            goto LABEL_591;
          }
        }
      }
    }
  }
  return 0;
}
