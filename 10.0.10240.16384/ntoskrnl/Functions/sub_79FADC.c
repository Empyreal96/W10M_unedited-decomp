// sub_79FADC 
 
int __fastcall sub_79FADC(int a1, int *a2)
{
  int v4; // r9
  int v5; // r2
  unsigned int v6; // r1
  unsigned int v7; // r0
  unsigned int v8; // r2
  int v9; // r5
  unsigned int v10; // r1
  int v11; // r3
  int v12; // r5
  int v13; // r6
  int v14; // r9
  int v15; // r8
  unsigned int v16; // r1
  int v17; // r0
  unsigned int v18; // r1
  __int16 v19; // r3
  int v20; // r4
  unsigned int v21; // r2
  int v22; // r0
  int v23; // r4
  int *v24; // r2
  int v25; // r1
  int v26; // r3
  int v27; // r0
  int v28; // r8
  int v29; // r4
  int v30; // r2
  int v31; // r1
  unsigned __int8 *v32; // r5
  int v33; // t1
  char *v34; // lr
  int v35; // r4
  int v36; // r1
  int j; // r2
  int v38; // t1
  unsigned int v39; // lr
  int v40; // r4
  int v41; // r2
  int v42; // r1
  unsigned int v43; // r5
  unsigned __int8 *v44; // lr
  int v45; // t1
  char *v46; // lr
  int v47; // r4
  int v48; // r1
  int i; // r2
  int v50; // t1
  unsigned int v51; // r0
  int v52; // r0
  unsigned int v53; // r1
  __int16 v54; // r3
  int *v55; // r3
  _DWORD *v56; // r8
  unsigned int v57; // r6
  int v58; // r9
  _DWORD *v59; // r4
  int v60; // r1
  int v61; // r2
  int v62; // r3
  char *v63; // r2
  unsigned int v64; // r2
  int v65; // r4
  unsigned int v66; // r1
  unsigned int v67; // r9
  unsigned int v68; // r1
  int v69; // r0
  unsigned int v70; // r1
  __int16 v71; // r3
  int v72; // r0
  unsigned int v73; // r2
  int v74; // r4
  unsigned int v75; // r1
  unsigned int v76; // r8
  unsigned int v77; // r3
  int v78; // r4
  int v79; // r0
  int v80; // r4
  int v81; // r1
  int v82; // r2
  unsigned int v83; // r1
  int v84; // r0
  unsigned int v85; // r1
  __int16 v86; // r3
  unsigned int v87; // r2
  int v88; // r0
  int v89; // r4
  unsigned int v90; // r1
  _DWORD *v91; // r4
  int v92; // r8
  bool v93; // zf
  _DWORD *v94; // r2
  int v95; // r1
  unsigned __int8 *v96; // r5
  int v97; // t1
  int v98; // lr
  int v99; // r1
  _DWORD *v100; // r2
  unsigned __int8 *v101; // r5
  int v102; // t1
  int v103; // r1
  int v104; // r0
  unsigned int v105; // r0
  int v106; // lr
  int v107; // r3
  _DWORD *v108; // r2
  int v109; // r1
  unsigned __int8 *v110; // r0
  int v111; // t1
  char *v112; // lr
  int v113; // r0
  int v114; // r1
  _DWORD *l; // r2
  int v116; // t1
  int v117; // r3
  int v118; // r1
  int v119; // r2
  int v120; // r3
  int v121; // r0
  unsigned int v122; // r0
  int v123; // lr
  int v124; // r3
  _DWORD *v125; // r2
  int v126; // r1
  unsigned __int8 *v127; // r0
  int v128; // t1
  char *v129; // lr
  int v130; // r1
  int v131; // r0
  _DWORD *k; // r2
  int v133; // t1
  int v134; // r3
  BOOL v135; // lr
  unsigned int v136; // r0
  int v137; // r0
  unsigned int v138; // r1
  __int16 v139; // r3
  int v140; // r3
  unsigned int v141; // r2
  int v142; // r0
  unsigned int v143; // r1
  unsigned int v144; // r0
  int v145; // r0
  unsigned int v146; // r1
  __int16 v147; // r3
  unsigned int v148; // r2
  int v149; // r0
  int *v150; // r2
  int v151; // r1
  int v152; // r3
  int v153; // r0
  unsigned int v154; // r0
  int v155; // lr
  int v156; // r10
  int v157; // r8
  int v158; // r2
  unsigned __int8 *v159; // r0
  int v160; // t1
  char *v161; // lr
  int v162; // r0
  int m; // r2
  int v164; // t1
  int v165; // r6
  unsigned int v166; // r0
  int v167; // r0
  unsigned int v168; // r1
  __int16 v169; // r3
  unsigned __int8 v171; // [sp+10h] [bp-2E8h]
  int v172; // [sp+14h] [bp-2E4h]
  int v173; // [sp+14h] [bp-2E4h]
  int v174; // [sp+14h] [bp-2E4h]
  int v175; // [sp+14h] [bp-2E4h]
  int v176; // [sp+14h] [bp-2E4h]
  int v177; // [sp+14h] [bp-2E4h]
  unsigned int v178; // [sp+18h] [bp-2E0h] BYREF
  int v179; // [sp+1Ch] [bp-2DCh] BYREF
  char v180; // [sp+20h] [bp-2D8h]
  int v181; // [sp+24h] [bp-2D4h]
  _DWORD *v182; // [sp+28h] [bp-2D0h] BYREF
  unsigned __int8 v183; // [sp+2Ch] [bp-2CCh]
  int *v184; // [sp+30h] [bp-2C8h]
  int v185; // [sp+34h] [bp-2C4h]
  int *v186; // [sp+38h] [bp-2C0h]
  char v187; // [sp+3Ch] [bp-2BCh]
  _DWORD *v188; // [sp+40h] [bp-2B8h]
  int v189; // [sp+44h] [bp-2B4h]
  int v190; // [sp+48h] [bp-2B0h]
  int v191; // [sp+4Ch] [bp-2ACh]
  int v192; // [sp+50h] [bp-2A8h] BYREF
  int *v193; // [sp+54h] [bp-2A4h]
  unsigned int v194; // [sp+58h] [bp-2A0h]
  int *v195; // [sp+5Ch] [bp-29Ch]
  unsigned __int8 v196; // [sp+60h] [bp-298h]
  int v197; // [sp+64h] [bp-294h]
  unsigned int v198; // [sp+68h] [bp-290h]
  int v199; // [sp+6Ch] [bp-28Ch]
  unsigned int v200; // [sp+70h] [bp-288h]
  _DWORD *v201; // [sp+78h] [bp-280h] BYREF
  int v202; // [sp+7Ch] [bp-27Ch]
  int v203; // [sp+80h] [bp-278h]
  int v204; // [sp+88h] [bp-270h]
  int v205; // [sp+8Ch] [bp-26Ch]
  int v206; // [sp+90h] [bp-268h]
  int v207; // [sp+94h] [bp-264h]
  int v208; // [sp+98h] [bp-260h]
  int v209; // [sp+9Ch] [bp-25Ch]
  char v210; // [sp+A0h] [bp-258h]
  int v211; // [sp+A8h] [bp-250h] BYREF
  int v212; // [sp+ACh] [bp-24Ch]
  int v213; // [sp+B0h] [bp-248h]
  int v214; // [sp+B8h] [bp-240h]
  int v215; // [sp+BCh] [bp-23Ch]
  int v216; // [sp+C0h] [bp-238h]
  int v217; // [sp+C4h] [bp-234h]
  int v218; // [sp+C8h] [bp-230h]
  int v219; // [sp+CCh] [bp-22Ch]
  char v220; // [sp+D0h] [bp-228h]
  _DWORD *v221; // [sp+D8h] [bp-220h] BYREF
  int v222; // [sp+DCh] [bp-21Ch]
  int v223; // [sp+E0h] [bp-218h]
  int v224; // [sp+E8h] [bp-210h]
  int v225; // [sp+ECh] [bp-20Ch]
  int v226; // [sp+F0h] [bp-208h]
  int v227; // [sp+F4h] [bp-204h]
  int v228; // [sp+F8h] [bp-200h]
  int v229; // [sp+FCh] [bp-1FCh]
  char v230; // [sp+100h] [bp-1F8h]
  int v231; // [sp+108h] [bp-1F0h] BYREF
  int v232; // [sp+10Ch] [bp-1ECh]
  int v233; // [sp+110h] [bp-1E8h]
  int v234; // [sp+118h] [bp-1E0h]
  int v235; // [sp+11Ch] [bp-1DCh]
  int v236; // [sp+120h] [bp-1D8h]
  int v237; // [sp+124h] [bp-1D4h]
  int v238; // [sp+128h] [bp-1D0h]
  int v239; // [sp+12Ch] [bp-1CCh]
  char v240; // [sp+130h] [bp-1C8h]
  int v241; // [sp+138h] [bp-1C0h]
  int v242; // [sp+13Ch] [bp-1BCh]
  int v243; // [sp+140h] [bp-1B8h] BYREF
  int v244; // [sp+144h] [bp-1B4h]
  int v245; // [sp+148h] [bp-1B0h]
  int v246; // [sp+150h] [bp-1A8h]
  int v247; // [sp+154h] [bp-1A4h]
  int v248; // [sp+158h] [bp-1A0h]
  int v249; // [sp+15Ch] [bp-19Ch]
  int v250; // [sp+160h] [bp-198h]
  int v251; // [sp+164h] [bp-194h]
  char v252; // [sp+168h] [bp-190h]
  _DWORD *v253; // [sp+170h] [bp-188h] BYREF
  int v254; // [sp+174h] [bp-184h]
  int v255; // [sp+178h] [bp-180h]
  int v256; // [sp+180h] [bp-178h]
  int v257; // [sp+184h] [bp-174h]
  int v258; // [sp+188h] [bp-170h]
  int v259; // [sp+18Ch] [bp-16Ch]
  int v260; // [sp+190h] [bp-168h]
  int v261; // [sp+194h] [bp-164h]
  char v262; // [sp+198h] [bp-160h]
  int v263; // [sp+1A0h] [bp-158h]
  int v264; // [sp+1A4h] [bp-154h]
  int v265; // [sp+1A8h] [bp-150h]
  int v266; // [sp+1ACh] [bp-14Ch]
  int v267; // [sp+1B0h] [bp-148h]
  int v268; // [sp+1B4h] [bp-144h]
  _BYTE v269[8]; // [sp+1B8h] [bp-140h] BYREF
  int v270; // [sp+1C0h] [bp-138h]
  char v271; // [sp+1E0h] [bp-118h]
  _BYTE v272[48]; // [sp+1E8h] [bp-110h] BYREF
  _BYTE v273[8]; // [sp+218h] [bp-E0h] BYREF
  int v274; // [sp+220h] [bp-D8h]
  _BYTE v275[8]; // [sp+248h] [bp-B0h] BYREF
  int v276; // [sp+250h] [bp-A8h]
  _BYTE v277[8]; // [sp+278h] [bp-80h] BYREF
  int v278; // [sp+280h] [bp-78h]
  _BYTE v279[8]; // [sp+2A8h] [bp-50h] BYREF
  int v280; // [sp+2B0h] [bp-48h]

  v186 = a2;
  v187 = 0;
  v196 = 0;
  v4 = 0;
  v183 = 0;
  v180 = 0;
  v191 = 0;
  v171 = 0;
  v188 = 0;
  v182 = 0;
  v185 = 0;
  v194 = 0;
  v181 = 0;
  v190 = 0;
  v189 = 0;
  v178 = 0;
  v184 = 0;
  v193 = 0;
  if ( !a2 || (unsigned int)(a1 - 25) > 0xFFE7 || ((unsigned __int8)a2 & 3) != 0 )
    goto LABEL_304;
  v5 = *a2;
  if ( (unsigned int)*a2 > 0x10000 || (v6 = a2[1], v6 > 0x10000) || (v7 = a2[2], v7 > 0x10000) )
  {
    v20 = -1073741760;
LABEL_305:
    v55 = 0;
    goto LABEL_306;
  }
  v195 = a2 + 5;
  v192 = (int)a2 + v6 + 20;
  v179 = v192;
  if ( (v192 & 3) != 0 || v7 + v6 + 20 != v5 || v5 != a1 || a2[4] != 1 )
  {
LABEL_304:
    v20 = -1073741811;
    goto LABEL_305;
  }
  v197 = 0;
  v8 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  --*(_WORD *)(v8 + 308);
  v9 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
  v188 = 0;
  v181 = 17;
  do
    v10 = __ldrex((unsigned int *)&dword_922C40);
  while ( !v10 && __strex(0x11u, (unsigned int *)&dword_922C40) );
  __dmb(0xBu);
  v181 = v10;
  if ( v10 )
    ExfAcquirePushLockSharedEx(&dword_922C40, v9, (unsigned int)&dword_922C40);
  if ( v9 )
    *(_BYTE *)(v9 + 14) |= 1u;
  if ( off_920350 )
  {
    v4 = 1;
    v183 = 1;
  }
  else
  {
    v171 = 1;
  }
  if ( InitSafeBootMode || InitIsWinPEMode )
  {
    if ( !v4 )
    {
      v11 = -1073741823;
LABEL_25:
      v197 = v11;
      goto LABEL_40;
    }
  }
  else if ( !v4 && (a2[3] & 1) != 0 )
  {
    v11 = -1073741811;
    goto LABEL_25;
  }
  v187 = 0;
  if ( !v4 )
  {
    v12 = dword_922C44;
    if ( dword_922C44 )
    {
      if ( !byte_920AF2 && *a2 == *(_DWORD *)dword_922C44 )
      {
        v13 = a2[1];
        v14 = *(_DWORD *)(dword_922C44 + 4);
        if ( v13 == v14 )
        {
          v15 = a2[2];
          if ( v15 == *(_DWORD *)(dword_922C44 + 8)
            && a2[3] == *(_DWORD *)(dword_922C44 + 12)
            && a2[4] == *(_DWORD *)(dword_922C44 + 16)
            && RtlCompareMemory((unsigned __int8 *)(dword_922C44 + 20), (int)(a2 + 5), a2[1]) == v13
            && RtlCompareMemory((unsigned __int8 *)(v14 + v12 + 20), v192, v15) == v15 )
          {
            v187 = 1;
          }
        }
      }
    }
  }
LABEL_40:
  __dmb(0xBu);
  do
    v16 = __ldrex((unsigned int *)&dword_922C40);
  while ( v16 == 17 && __strex(0, (unsigned int *)&dword_922C40) );
  if ( v16 != 17 )
    ExfReleasePushLockShared(&dword_922C40);
  v17 = KeAbPostRelease((unsigned int)&dword_922C40);
  v18 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  v19 = *(_WORD *)(v18 + 0x134) + 1;
  *(_WORD *)(v18 + 308) = v19;
  if ( !v19 && *(_DWORD *)(v18 + 100) != v18 + 100 && !*(_WORD *)(v18 + 310) )
    KiCheckForKernelApcDelivery(v17);
  v20 = v197;
  if ( v197 < 0 )
  {
    v191 = v171;
    v188 = v182;
    v185 = v194;
    v181 = 0;
    goto LABEL_299;
  }
  if ( v187 == 1 )
  {
    v21 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    --*(_WORD *)(v21 + 308);
    v22 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
    v23 = v22;
    v24 = &dword_922C40;
    do
      v25 = __ldrex((unsigned __int8 *)&dword_922C40);
    while ( __strex(v25 | 1, (unsigned __int8 *)&dword_922C40) );
    __dmb(0xBu);
    if ( (v25 & 1) != 0 )
      ExfAcquirePushLockExclusiveEx(&dword_922C40, v22, (unsigned int)&dword_922C40);
    if ( v23 )
      *(_BYTE *)(v23 + 14) |= 1u;
    if ( !dword_922C44 )
    {
      v26 = dword_920284;
      goto LABEL_83;
    }
    v27 = sub_6E2570((int)v279, v25, (int)v24, dword_922C44);
    if ( v27 >= 0 )
    {
      v26 = v280;
      goto LABEL_83;
    }
    if ( v27 != -1073741275 )
    {
LABEL_82:
      v26 = 4;
LABEL_83:
      v185 = v26 != 0;
      v39 = dword_922C3C;
      v190 = dword_922C3C;
      v181 = 0;
      v243 = 0;
      v178 = 0;
      v244 = 0;
      v246 = 0;
      v247 = 0;
      v245 = 0;
      v248 = 0;
      v249 = 0;
      v250 = 10800;
      v251 = 0;
      v252 = 1;
      v188 = (_DWORD *)v186[1];
      v192 = (int)(v186 + 5);
      v40 = 0;
      if ( v186 == (int *)-20 )
      {
        v40 = -1073741811;
      }
      else
      {
        v41 = 0;
        v181 = 0;
        v42 = 0;
        v178 = 0;
        if ( v188 )
        {
          v43 = (unsigned int)v188;
          v44 = (unsigned __int8 *)v192;
          do
          {
            v45 = *v44++;
            v42 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v45 - 23737705 + v42), 21), 21), 21);
            v41 += v45 - 23737705 + v42;
            --v43;
          }
          while ( v43 );
          v181 = v41;
          v178 = v42;
          v39 = v190;
        }
        v243 = v41;
        v244 = v42;
      }
      if ( !v40 )
      {
        if ( !v39 )
        {
LABEL_98:
          memmove((int)v272, (int)&v243, 0x30u);
          sub_6E34A4((int)v272, 7, 1);
          __dmb(0xBu);
          do
            v51 = __ldrex((unsigned int *)&dword_922C40);
          while ( __strex(v51 - 1, (unsigned int *)&dword_922C40) );
          if ( (v51 & 2) != 0 && (v51 & 4) == 0 )
            ExfTryToWakePushLock((unsigned int *)&dword_922C40);
          v52 = KeAbPostRelease((unsigned int)&dword_922C40);
          v53 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
          v54 = *(_WORD *)(v53 + 0x134) + 1;
          *(_WORD *)(v53 + 308) = v54;
          if ( !v54 && *(_DWORD *)(v53 + 100) != v53 + 100 && !*(_WORD *)(v53 + 310) )
            v52 = KiCheckForKernelApcDelivery(v52);
          if ( v185 )
            sub_8A1140(v52);
          v20 = 0x40000000;
          v191 = v171;
          v55 = 0;
          v188 = v182;
          v185 = v194;
          v181 = 0;
          v190 = v189;
          v184 = v193;
          goto LABEL_306;
        }
        if ( !RtlULongLongToULong(8 * v39, v39 >> 29, &v192) )
        {
          v46 = byte_922C48;
          v47 = v192;
          v48 = v178;
          for ( i = v181; v47; --v47 )
          {
            v50 = (unsigned __int8)*v46++;
            v48 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v50 - 23737705 + v48), 21), 21), 21);
            i += v50 - 23737705 + v48;
          }
          v243 = i;
          v244 = v48;
          goto LABEL_98;
        }
      }
      v243 = 0;
      v244 = 0;
      v245 = 4;
      goto LABEL_98;
    }
    if ( !dword_922C44 )
    {
      v29 = -1073741811;
LABEL_80:
      if ( v29 >= 0 )
      {
        v280 = 4;
        sub_6E34A4((int)v279, -1, 0);
      }
      goto LABEL_82;
    }
    v181 = 0;
    v231 = 0;
    v178 = 0;
    v232 = 0;
    v234 = 0;
    v235 = 0;
    v233 = 4;
    v236 = 0;
    v237 = 0;
    v238 = 0;
    v239 = 0;
    v240 = 1;
    v28 = *(_DWORD *)(dword_922C44 + 4);
    v192 = dword_922C44 + 20;
    v29 = 0;
    if ( dword_922C44 == -20 )
    {
      v29 = -1073741811;
    }
    else
    {
      v30 = 0;
      v181 = 0;
      v31 = 0;
      v178 = 0;
      if ( v28 )
      {
        v32 = (unsigned __int8 *)v192;
        do
        {
          v33 = *v32++;
          v31 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v33 - 23737705 + v31), 21), 21), 21);
          v30 += v33 - 23737705 + v31;
          --v28;
        }
        while ( v28 );
        v181 = v30;
        v178 = v31;
      }
      v231 = v30;
      v232 = v31;
    }
    if ( !v29 )
    {
      if ( !dword_922C3C )
        goto LABEL_78;
      if ( !RtlULongLongToULong(8 * dword_922C3C, (unsigned int)dword_922C3C >> 29, &v192) )
      {
        v34 = byte_922C48;
        v35 = v192;
        v36 = v178;
        for ( j = v181; v35; --v35 )
        {
          v38 = (unsigned __int8)*v34++;
          v36 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v38 - 23737705 + v36), 21), 21), 21);
          j += v38 - 23737705 + v36;
        }
        v231 = j;
        v232 = v36;
        v29 = 0;
        goto LABEL_78;
      }
    }
    v231 = 0;
    v232 = 0;
    v233 = 4;
    v29 = 0;
LABEL_78:
    memmove((int)v279, (int)&v231, 0x30u);
    goto LABEL_80;
  }
  v263 = 24;
  v264 = 0;
  v266 = 544;
  v265 = 0;
  v267 = 0;
  v268 = 0;
  v56 = v186;
  v241 = *v186;
  v242 = 0;
  v57 = 0;
  v20 = ZwCreateSection();
  if ( v20 < 0 )
  {
    v191 = v171;
    v188 = v182;
    v185 = v194;
    v181 = 0;
    goto LABEL_299;
  }
  v20 = ObReferenceObjectByHandle(v199, 0, 0, 0, (int)&v192, 0);
  v58 = v192;
  v181 = v192;
  v172 = v192;
  ZwClose();
  if ( v20 < 0 || (v192 = 0, v20 = MmMapViewInSystemSpace(v58, (int)&v182, (int)&v192), v20 < 0) )
  {
    v191 = v171;
    v188 = v182;
    goto LABEL_298;
  }
  v59 = v182;
  v188 = v182;
  v60 = v56[1];
  v61 = v56[2];
  v62 = v56[3];
  *v182 = *v56;
  v59[1] = v60;
  v59[2] = v61;
  v59[3] = v62;
  v59[4] = v56[4];
  memmove((int)(v59 + 5), (int)v195, v56[1]);
  memmove((int)v59 + v56[1] + 20, v179, v56[2]);
  v63 = (char *)v59 + v59[1];
  if ( v59[2] != 4 || v63 == (char *)-20 || *((_DWORD *)v63 + 5) != 69 )
  {
    v20 = -1073741761;
    v191 = v171;
LABEL_298:
    v185 = v194;
LABEL_299:
    v186 = 0;
    v190 = v189;
    v184 = v193;
    v55 = 0;
    goto LABEL_306;
  }
  v20 = sub_7A0ED8(v59, 1, 0, 0, &v178);
  if ( v20 == -1073741789 )
  {
    v64 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    --*(_WORD *)(v64 + 308);
    v65 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
    do
      v66 = __ldrex((unsigned int *)&dword_922C40);
    while ( !v66 && __strex(0x11u, (unsigned int *)&dword_922C40) );
    __dmb(0xBu);
    if ( v66 )
      ExfAcquirePushLockSharedEx(&dword_922C40, v65, (unsigned int)&dword_922C40);
    if ( v65 )
      *(_BYTE *)(v65 + 14) |= 1u;
    v67 = v178;
    if ( v178 <= 0x923 )
      v20 = 0;
    else
      v20 = -1073741811;
    __dmb(0xBu);
    do
      v68 = __ldrex((unsigned int *)&dword_922C40);
    while ( v68 == 17 && __strex(0, (unsigned int *)&dword_922C40) );
    if ( v68 != 17 )
      ExfReleasePushLockShared(&dword_922C40);
    v69 = KeAbPostRelease((unsigned int)&dword_922C40);
    v70 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    v71 = *(_WORD *)(v70 + 0x134) + 1;
    *(_WORD *)(v70 + 308) = v71;
    if ( !v71 && *(_DWORD *)(v70 + 100) != v70 + 100 && !*(_WORD *)(v70 + 310) )
      KiCheckForKernelApcDelivery(v69);
    if ( v20 < 0 )
    {
      v191 = v171;
      v55 = 0;
      v185 = v194;
      v190 = v189;
      v184 = v193;
      goto LABEL_306;
    }
    v72 = ExAllocatePoolWithTag(1, 8 * v67, 542329939);
    v184 = (int *)v72;
    v193 = (int *)v72;
    if ( !v72 )
    {
      v20 = -1073741801;
      v191 = v171;
      v55 = 0;
      v185 = v194;
      v190 = v189;
      goto LABEL_306;
    }
    v20 = sub_7A0ED8(v188, 0, v72, v67, 0);
    if ( v20 < 0 )
      goto LABEL_144;
    qsort((unsigned int)v184, v67, 8u, (int (__fastcall *)(unsigned int, _BYTE *))sub_6C7BFC);
  }
  else
  {
    v67 = v178;
    v184 = v193;
  }
  if ( v20 < 0 )
  {
LABEL_144:
    v55 = 0;
    v191 = v171;
    v185 = v194;
    v190 = v189;
    if ( v20 == -1073741762 )
      v20 = -1073741811;
    goto LABEL_306;
  }
  v180 = 0;
  v73 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  --*(_WORD *)(v73 + 308);
  v74 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
  v195 = 0;
  v179 = 17;
  do
    v75 = __ldrex((unsigned int *)&dword_922C40);
  while ( !v75 && __strex(0x11u, (unsigned int *)&dword_922C40) );
  __dmb(0xBu);
  v179 = v75;
  if ( v75 )
    ExfAcquirePushLockSharedEx(&dword_922C40, v74, (unsigned int)&dword_922C40);
  if ( v74 )
    *(_BYTE *)(v74 + 14) |= 1u;
  if ( !v183 )
  {
    v198 = 0;
    v76 = 0;
    v200 = 0;
    v77 = dword_922C3C;
    v181 = dword_922C3C;
    while ( v57 < v67 )
    {
      if ( v76 >= v77 )
      {
        while ( v57 < v67 )
        {
          if ( (*(_DWORD *)(v184[2 * v57 + 1] + 8) & 2) != 0 )
            goto LABEL_170;
          v198 = ++v57;
        }
        break;
      }
      v78 = (int)&v184[2 * v57];
      v79 = sub_6C7BFC(v78, (int)&byte_922C48[8 * v76]);
      v80 = *(_DWORD *)(v78 + 4);
      v81 = *(_DWORD *)&byte_922C48[8 * v76 + 4];
      if ( v79 >= 0 )
      {
        if ( v79 <= 0 )
        {
          if ( (*(_DWORD *)(v80 + 8) & 2) != 0 )
          {
            v82 = *(unsigned __int16 *)(v81 + 6);
            if ( *(unsigned __int16 *)(v80 + 6) != v82
              || memcmp(*(unsigned __int16 *)(v80 + 2) + v80 + 16, *(unsigned __int16 *)(v81 + 2) + v81 + 16, v82) )
            {
LABEL_170:
              v180 = 1;
              break;
            }
          }
          v198 = ++v57;
          v200 = ++v76;
        }
        else
        {
          v200 = ++v76;
        }
      }
      else
      {
        if ( (*(_DWORD *)(v80 + 8) & 2) != 0 )
          goto LABEL_170;
        v198 = ++v57;
      }
      v77 = v181;
    }
  }
  __dmb(0xBu);
  do
    v83 = __ldrex((unsigned int *)&dword_922C40);
  while ( v83 == 17 && __strex(0, (unsigned int *)&dword_922C40) );
  if ( v83 != 17 )
    ExfReleasePushLockShared(&dword_922C40);
  v84 = KeAbPostRelease((unsigned int)&dword_922C40);
  v85 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  v86 = *(_WORD *)(v85 + 0x134) + 1;
  *(_WORD *)(v85 + 308) = v86;
  if ( !v86 && *(_DWORD *)(v85 + 100) != v85 + 100 && !*(_WORD *)(v85 + 310) )
    KiCheckForKernelApcDelivery(v84);
  v181 = v172;
  ObfReferenceObject(v172);
  v87 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  --*(_WORD *)(v87 + 308);
  v88 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
  v89 = v88;
  do
    v90 = __ldrex((unsigned __int8 *)&dword_922C40);
  while ( __strex(v90 | 1, (unsigned __int8 *)&dword_922C40) );
  __dmb(0xBu);
  if ( (v90 & 1) != 0 )
    ExfAcquirePushLockExclusiveEx(&dword_922C40, v88, (unsigned int)&dword_922C40);
  if ( v89 )
    *(_BYTE *)(v89 + 14) |= 1u;
  v91 = v182;
  v188 = v182;
  if ( v182 )
  {
    if ( v178 )
    {
      v184 = v193;
      if ( !v193 )
        goto LABEL_212;
    }
    else
    {
      v184 = v193;
    }
    v182 = 0;
    v221 = 0;
    v173 = 0;
    v222 = 0;
    v224 = 0;
    v225 = 0;
    v223 = 0;
    v226 = 0;
    v227 = 0;
    v228 = 10800;
    v229 = 0;
    v230 = 1;
    v92 = v91[1];
    v93 = v91 + 5 == 0;
    v179 = (int)(v91 + 5);
    v20 = 0;
    if ( v93 )
    {
      v20 = -1073741811;
    }
    else
    {
      v94 = 0;
      v182 = 0;
      v95 = 0;
      v173 = 0;
      if ( v92 )
      {
        v96 = (unsigned __int8 *)v179;
        do
        {
          v97 = *v96++;
          v95 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v97 - 23737705 + v95), 21), 21), 21);
          v94 = (_DWORD *)((char *)v94 + v97 + v95 - 23737705);
          --v92;
        }
        while ( v92 );
        v182 = v94;
        v173 = v95;
      }
      v221 = v94;
      v222 = v95;
    }
    if ( v20 )
      goto LABEL_209;
    if ( v178 )
    {
      if ( RtlULongLongToULong(8 * v178, v178 >> 29, &v179) )
        goto LABEL_209;
      v20 = 0;
      if ( v184 )
      {
        v195 = v184;
        v98 = v179;
        v99 = v173;
        v100 = v182;
        if ( v179 )
        {
          v101 = (unsigned __int8 *)v184;
          do
          {
            v102 = *v101++;
            v99 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v102 - 23737705 + v99), 21), 21), 21);
            v100 = (_DWORD *)((char *)v100 + v102 + v99 - 23737705);
            --v98;
          }
          while ( v98 );
        }
        v221 = v100;
        v222 = v99;
      }
      else
      {
        v20 = -1073741811;
      }
    }
    if ( !v20 )
    {
LABEL_210:
      memmove((int)v272, (int)&v221, 0x30u);
      goto LABEL_213;
    }
LABEL_209:
    v221 = 0;
    v222 = 0;
    v223 = 4;
    v20 = 0;
    goto LABEL_210;
  }
  v184 = v193;
LABEL_212:
  v20 = -1073741811;
LABEL_213:
  if ( v20 >= 0 )
  {
    sub_6E34A4((int)v272, 7, 1);
    v190 = dword_927560;
    v185 = dword_922C44;
    dword_927560 = v181;
    dword_922C44 = (int)v188;
    v188 = 0;
    off_920350 = 0;
    v186 = (int *)(unsigned __int8)byte_920AF2;
    byte_920AF2 = 0;
    memset(byte_922C48, 0, 8 * dword_922C3C);
    dword_922C3C = 0;
    v103 = (int)v184;
    if ( v184 )
    {
      memmove((int)byte_922C48, (int)v184, 8 * v178);
      dword_922C3C = v178;
    }
    byte_920AF3 = 1;
    if ( !dword_922C44 )
    {
      v189 = dword_920284;
      goto LABEL_242;
    }
    v104 = sub_6E2570((int)v275, v103, 1, dword_922C44);
    if ( v104 >= 0 )
    {
      v189 = v276;
      goto LABEL_242;
    }
    if ( v104 != -1073741275 )
    {
LABEL_241:
      v189 = 4;
LABEL_242:
      if ( (*(_DWORD *)(dword_922C44 + 12) & 1) != 0 )
      {
        dword_920284 = 2;
        v270 = 2;
        sub_6E34A4((int)v269, 2, 0);
        v119 = 1;
        v191 = 1;
      }
      else
      {
        dword_920284 = 0;
        v270 = 0;
        sub_6E34A4((int)v269, 2, 0);
        v191 = v171;
      }
      if ( !dword_922C44 )
      {
        v120 = dword_920284;
        goto LABEL_271;
      }
      v121 = sub_6E2570((int)v273, v118, v119, dword_922C44);
      if ( v121 >= 0 )
      {
        v120 = v274;
        goto LABEL_271;
      }
      if ( v121 != -1073741275 )
      {
LABEL_270:
        v120 = 4;
LABEL_271:
        v135 = v189 != v120 && (!v189 || !v120);
        v176 = v135;
        goto LABEL_278;
      }
      v122 = dword_922C3C;
      v195 = (int *)dword_922C3C;
      if ( !dword_922C44 )
      {
        v134 = -1073741811;
LABEL_268:
        if ( v134 >= 0 )
        {
          v274 = 4;
          sub_6E34A4((int)v273, -1, 0);
        }
        goto LABEL_270;
      }
      v182 = 0;
      v253 = 0;
      v175 = 0;
      v254 = 0;
      v256 = 0;
      v257 = 0;
      v255 = 4;
      v258 = 0;
      v259 = 0;
      v260 = 0;
      v261 = 0;
      v262 = 1;
      v123 = *(_DWORD *)(dword_922C44 + 4);
      v179 = dword_922C44 + 20;
      v124 = 0;
      v178 = 0;
      if ( dword_922C44 == -20 )
      {
        v124 = -1073741811;
        v178 = -1073741811;
      }
      else
      {
        v125 = 0;
        v182 = 0;
        v126 = 0;
        v175 = 0;
        if ( v123 )
        {
          v127 = (unsigned __int8 *)v179;
          do
          {
            v128 = *v127++;
            v126 = __ROR4__(
                     -23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v128 - 23737705 + v126), 21), 21),
                     21);
            v125 = (_DWORD *)((char *)v125 + v128 + v126 - 23737705);
            --v123;
          }
          while ( v123 );
          v182 = v125;
          v175 = v126;
          v124 = 0;
          v122 = (unsigned int)v195;
        }
        v253 = v125;
        v254 = v126;
      }
      if ( !v124 )
      {
        if ( !v122 )
          goto LABEL_266;
        v178 = RtlULongLongToULong(8 * v122, v122 >> 29, &v179);
        if ( !v178 )
        {
          v129 = byte_922C48;
          v130 = v179;
          v131 = v175;
          for ( k = v182; v130; --v130 )
          {
            v133 = (unsigned __int8)*v129++;
            v131 = __ROR4__(
                     -23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v133 - 23737705 + v131), 21), 21),
                     21);
            k = (_DWORD *)((char *)k + v133 + v131 - 23737705);
          }
          v253 = k;
          v254 = v131;
          v178 = 0;
          goto LABEL_266;
        }
      }
      v253 = 0;
      v254 = 0;
      v255 = 4;
      v178 = 0;
LABEL_266:
      memmove((int)v273, (int)&v253, 0x30u);
      v134 = v178;
      goto LABEL_268;
    }
    v105 = dword_922C3C;
    v195 = (int *)dword_922C3C;
    if ( !dword_922C44 )
    {
      v117 = -1073741811;
LABEL_239:
      if ( v117 >= 0 )
      {
        v276 = 4;
        sub_6E34A4((int)v275, -1, 0);
      }
      goto LABEL_241;
    }
    v182 = 0;
    v201 = 0;
    v174 = 0;
    v202 = 0;
    v204 = 0;
    v205 = 0;
    v203 = 4;
    v206 = 0;
    v207 = 0;
    v208 = 0;
    v209 = 0;
    v210 = 1;
    v106 = *(_DWORD *)(dword_922C44 + 4);
    v179 = dword_922C44 + 20;
    v107 = 0;
    v178 = 0;
    if ( dword_922C44 == -20 )
    {
      v107 = -1073741811;
      v178 = -1073741811;
    }
    else
    {
      v108 = 0;
      v182 = 0;
      v109 = 0;
      v174 = 0;
      if ( v106 )
      {
        v110 = (unsigned __int8 *)v179;
        do
        {
          v111 = *v110++;
          v109 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v111 - 23737705 + v109), 21), 21), 21);
          v108 = (_DWORD *)((char *)v108 + v111 + v109 - 23737705);
          --v106;
        }
        while ( v106 );
        v182 = v108;
        v174 = v109;
        v107 = 0;
        v105 = (unsigned int)v195;
      }
      v201 = v108;
      v202 = v109;
    }
    if ( !v107 )
    {
      if ( !v105 )
        goto LABEL_237;
      v178 = RtlULongLongToULong(8 * v105, v105 >> 29, &v179);
      if ( !v178 )
      {
        v112 = byte_922C48;
        v113 = v179;
        v114 = v174;
        for ( l = v182; v113; --v113 )
        {
          v116 = (unsigned __int8)*v112++;
          v114 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v116 - 23737705 + v114), 21), 21), 21);
          l = (_DWORD *)((char *)l + v116 + v114 - 23737705);
        }
        v201 = l;
        v202 = v114;
        v178 = 0;
        goto LABEL_237;
      }
    }
    v201 = 0;
    v202 = 0;
    v203 = 4;
    v178 = 0;
LABEL_237:
    memmove((int)v275, (int)&v201, 0x30u);
    v117 = v178;
    goto LABEL_239;
  }
  v176 = v196;
  v191 = v171;
  v186 = 0;
  v185 = v194;
  v190 = v189;
LABEL_278:
  __dmb(0xBu);
  do
    v136 = __ldrex((unsigned int *)&dword_922C40);
  while ( __strex(v136 - 1, (unsigned int *)&dword_922C40) );
  if ( (v136 & 2) != 0 && (v136 & 4) == 0 )
    ExfTryToWakePushLock((unsigned int *)&dword_922C40);
  v137 = KeAbPostRelease((unsigned int)&dword_922C40);
  v138 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
  v139 = *(_WORD *)(v138 + 0x134) + 1;
  *(_WORD *)(v138 + 308) = v139;
  if ( !v139 && *(_DWORD *)(v138 + 100) != v138 + 100 && !*(_WORD *)(v138 + 310) )
    v137 = KiCheckForKernelApcDelivery(v137);
  if ( v20 < 0 )
    goto LABEL_296;
  v140 = v183;
  if ( v183 )
    goto LABEL_291;
  v137 = sub_7660C8();
  v20 = v137;
  if ( v137 < 0 )
  {
LABEL_296:
    v55 = v186;
    goto LABEL_306;
  }
  v140 = v183;
LABEL_291:
  if ( v176 || !v140 )
    sub_8A1140(v137);
  v20 = 0;
  v55 = v186;
  if ( v180 == 1 )
    v20 = 263;
LABEL_306:
  if ( v55 && !byte_920AF2 )
    sub_7663CC((int)KernelLicensingCacheCorruptionFixed);
  if ( v191 )
  {
    v141 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    --*(_WORD *)(v141 + 308);
    v142 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
    v179 = v142;
    do
      v143 = __ldrex((unsigned __int8 *)&dword_922C40);
    while ( __strex(v143 | 1, (unsigned __int8 *)&dword_922C40) );
    __dmb(0xBu);
    if ( (v143 & 1) != 0 )
    {
      ExfAcquirePushLockExclusiveEx(&dword_922C40, v142, (unsigned int)&dword_922C40);
      v142 = v179;
    }
    if ( v142 )
      *(_BYTE *)(v142 + 14) |= 1u;
    v271 = 0;
    sub_6E34A4((int)v269, 32, 0);
    __dmb(0xBu);
    do
      v144 = __ldrex((unsigned int *)&dword_922C40);
    while ( __strex(v144 - 1, (unsigned int *)&dword_922C40) );
    if ( (v144 & 2) != 0 && (v144 & 4) == 0 )
      ExfTryToWakePushLock((unsigned int *)&dword_922C40);
    v145 = KeAbPostRelease((unsigned int)&dword_922C40);
    v146 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    v147 = *(_WORD *)(v146 + 0x134) + 1;
    *(_WORD *)(v146 + 308) = v147;
    if ( !v147 && *(_DWORD *)(v146 + 100) != v146 + 100 && !*(_WORD *)(v146 + 310) )
      KiCheckForKernelApcDelivery(v145);
  }
  if ( v181 )
    ObfDereferenceObject(v181);
  if ( v190 )
    ObfDereferenceObject(v190);
  if ( v188 )
    MmUnmapViewInSystemSpace((unsigned int)v188);
  if ( v185 )
    MmUnmapViewInSystemSpace(v185);
  if ( v184 )
    ExFreePoolWithTag((unsigned int)v184);
  if ( v20 == -1073741811 || v20 == -1073741760 || v20 == -1073741761 )
  {
    v148 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
    --*(_WORD *)(v148 + 308);
    v149 = KeAbPreAcquire((unsigned int)&dword_922C40, 0, 0);
    v179 = v149;
    v150 = &dword_922C40;
    do
      v151 = __ldrex((unsigned __int8 *)&dword_922C40);
    while ( __strex(v151 | 1, (unsigned __int8 *)&dword_922C40) );
    __dmb(0xBu);
    if ( (v151 & 1) != 0 )
    {
      ExfAcquirePushLockExclusiveEx(&dword_922C40, v149, (unsigned int)&dword_922C40);
      v149 = v179;
    }
    if ( v149 )
      *(_BYTE *)(v149 + 14) |= 1u;
    if ( !dword_922C44 )
    {
      v152 = dword_920284;
LABEL_370:
      if ( v152 )
      {
        v165 = 0;
      }
      else
      {
        dword_920284 = 5;
        v270 = 5;
        sub_6E34A4((int)v269, 2, 0);
        v165 = 1;
      }
      __dmb(0xBu);
      do
        v166 = __ldrex((unsigned int *)&dword_922C40);
      while ( __strex(v166 - 1, (unsigned int *)&dword_922C40) );
      if ( (v166 & 2) != 0 && (v166 & 4) == 0 )
        ExfTryToWakePushLock((unsigned int *)&dword_922C40);
      v167 = KeAbPostRelease((unsigned int)&dword_922C40);
      v168 = __mrc(15, 0, 13, 0, 3) & 0xFFFFFFC0;
      v169 = *(_WORD *)(v168 + 0x134) + 1;
      *(_WORD *)(v168 + 308) = v169;
      if ( !v169 && *(_DWORD *)(v168 + 100) != v168 + 100 && !*(_WORD *)(v168 + 310) )
        v167 = KiCheckForKernelApcDelivery(v167);
      if ( v165 )
        sub_8A1140(v167);
      return v20;
    }
    v153 = sub_6E2570((int)v277, v151, (int)v150, dword_922C44);
    if ( v153 >= 0 )
    {
      v152 = v278;
      goto LABEL_370;
    }
    if ( v153 != -1073741275 )
    {
LABEL_369:
      v152 = 4;
      goto LABEL_370;
    }
    v154 = dword_922C3C;
    v195 = (int *)dword_922C3C;
    if ( !dword_922C44 )
    {
      v156 = -1073741811;
LABEL_367:
      if ( v156 >= 0 )
      {
        v278 = 4;
        sub_6E34A4((int)v277, -1, 0);
      }
      goto LABEL_369;
    }
    v177 = 0;
    v211 = 0;
    v212 = 0;
    v214 = 0;
    v215 = 0;
    v213 = 4;
    v216 = 0;
    v217 = 0;
    v218 = 0;
    v219 = 0;
    v220 = 1;
    v155 = *(_DWORD *)(dword_922C44 + 4);
    v179 = dword_922C44 + 20;
    v156 = 0;
    if ( dword_922C44 == -20 )
    {
      v156 = -1073741811;
      v157 = 0;
    }
    else
    {
      v158 = 0;
      v177 = 0;
      v157 = 0;
      if ( v155 )
      {
        v159 = (unsigned __int8 *)v179;
        do
        {
          v160 = *v159++;
          v157 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v160 - 23737705 + v157), 21), 21), 21);
          v158 += v160 - 23737705 + v157;
          --v155;
        }
        while ( v155 );
        v177 = v158;
        v154 = (unsigned int)v195;
      }
      v211 = v158;
      v212 = v157;
    }
    if ( !v156 )
    {
      if ( !v154 )
        goto LABEL_365;
      if ( !RtlULongLongToULong(8 * v154, v154 >> 29, &v179) )
      {
        v161 = byte_922C48;
        v162 = v179;
        for ( m = v177; v162; --v162 )
        {
          v164 = (unsigned __int8)*v161++;
          v157 = __ROR4__(-23737705 * __ROR4__(-23737705 * __ROR4__(-23737705 * (v164 - 23737705 + v157), 21), 21), 21);
          m += v164 - 23737705 + v157;
        }
        v211 = m;
        v212 = v157;
        v156 = 0;
        goto LABEL_365;
      }
    }
    v211 = 0;
    v212 = 0;
    v213 = 4;
    v156 = 0;
LABEL_365:
    memmove((int)v277, (int)&v211, 0x30u);
    goto LABEL_367;
  }
  return v20;
}
